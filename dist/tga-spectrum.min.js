!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TGASpectrum={})}(this,(function(t){"use strict";const e=Object.prototype.toString;function r(t){return e.call(t).endsWith("Array]")}const n=Object.prototype.toString;var i=function(t){return n.call(t).endsWith("Array]")};function o(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var e=t[0],r=1;r<t.length;r++)t[r]>e&&(e=t[r]);return e}function s(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var e=t[0],r=1;r<t.length;r++)t[r]<e&&(e=t[r]);return e}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var u=l((function(t){!function(){function e(t){for(var e=0,i=t.length-1,o=void 0,s=void 0,a=void 0,l=n(e,i);;){if(i<=e)return t[l];if(i==e+1)return t[e]>t[i]&&r(t,e,i),t[l];for(t[o=n(e,i)]>t[i]&&r(t,o,i),t[e]>t[i]&&r(t,e,i),t[o]>t[e]&&r(t,o,e),r(t,o,e+1),s=e+1,a=i;;){do{s++}while(t[e]>t[s]);do{a--}while(t[a]>t[e]);if(a<s)break;r(t,s,a)}r(t,e,a),a<=l&&(e=s),a>=l&&(i=a-1)}}var r=function(t,e,r){var n;return n=[t[r],t[e]],t[e]=n[0],t[r]=n[1],n},n=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()}));function h(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");return u(t.slice())}function f(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]+r;else for(let r=0;r<t.length;r++)i[r]=t[r]+e[r];return i}function c(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Float64Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]*r;else for(let r=0;r<t.length;r++)i[r]=t[r]*e[r];return i}function m(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]/r;else for(let r=0;r<t.length;r++)i[r]=t[r]/e[r];return i}function p(t){if(t.length<3)return!0;if(t[0]<t[1]){for(let e=0;e<t.length-1;e++)if(t[e]>=t[e+1])return!1}else for(let e=0;e<t.length-1;e++)if(t[e]<=t[e+1])return!1;return!0}var d,g=Object.prototype.toString,w=function(t){var e=g.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===g.call(t.callee)),r};if(!Object.keys){var y=Object.prototype.hasOwnProperty,b=Object.prototype.toString,v=w,x=Object.prototype.propertyIsEnumerable,M=!x.call({toString:null},"toString"),E=x.call((function(){}),"prototype"),S=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],k=function(t){var e=t.constructor;return e&&e.prototype===t},A={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},T=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!A["$"+t]&&y.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{k(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();d=function(t){var e=null!==t&&"object"==typeof t,r="[object Function]"===b.call(t),n=v(t),i=e&&"[object String]"===b.call(t),o=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var s=E&&r;if(i&&t.length>0&&!y.call(t,0))for(var a=0;a<t.length;++a)o.push(String(a));if(n&&t.length>0)for(var l=0;l<t.length;++l)o.push(String(l));else for(var u in t)s&&"prototype"===u||!y.call(t,u)||o.push(String(u));if(M)for(var h=function(t){if("undefined"==typeof window||!T)return k(t);try{return k(t)}catch(t){return!1}}(t),f=0;f<S.length;++f)h&&"constructor"===S[f]||!y.call(t,S[f])||o.push(S[f]);return o}}var _=d,R=Array.prototype.slice,C=Object.keys,N=C?function(t){return C(t)}:_,F=Object.keys;N.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return w(t)?F(R.call(t)):F(t)}):Object.keys=N;return Object.keys||N};var O=N,I=(O.shim(),{Int8Array:null,Uint8Array:null,Uint8ClampedArray:null,Int16Array:null,Uint16Array:null,Int32Array:null,Uint32Array:null,Float32Array:null,Float64Array:null});!function(){var t,e,r=O(I),n=r.length;for(e=0;e<n;e++)t=r[e],I[t]=new Function("arr","return new "+t+"( arr );")}();l((function(t,e){!function(t){function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function r(t){var r;return 1===t.length&&(r=t,t=function(t,n){return e(r(t),n)}),{left:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)<0?n=o+1:i=o}return n},right:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)>0?i=o:n=o+1}return n}}}var n=r(e),i=n.right,o=n.left;function s(t){return null===t?NaN:+t}function a(t,e){var r,n,i=t.length,o=0,a=0,l=-1,u=0;if(null==e)for(;++l<i;)isNaN(r=s(t[l]))||(a+=(n=r-o)*(r-(o+=n/++u)));else for(;++l<i;)isNaN(r=s(e(t[l],l,t)))||(a+=(n=r-o)*(r-(o+=n/++u)));if(u>1)return a/(u-1)}function l(t,e){var r=a(t,e);return r?Math.sqrt(r):r}function u(t,e){var r,n,i,o=-1,s=t.length;if(null==e){for(;++o<s;)if(null!=(n=t[o])&&n>=n){r=i=n;break}for(;++o<s;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else{for(;++o<s;)if(null!=(n=e(t[o],o,t))&&n>=n){r=i=n;break}for(;++o<s;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]}function h(t){return function(){return t}}function f(t){return t}function c(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((e-t)/r)),o=new Array(i);++n<i;)o[n]=t+n*r;return o}var m=Math.sqrt(50),p=Math.sqrt(10),d=Math.sqrt(2);function g(t,e,r){var n=w(t,e,r);return c(Math.ceil(t/n)*n,Math.floor(e/n)*n+n/2,n)}function w(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=m?i*=10:o>=p?i*=5:o>=d&&(i*=2),e<t?-i:i}function y(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function b(t){return+t}function v(t,e,r){if(null==r&&(r=s),n=t.length){if((e=+e)<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,o=Math.floor(i),a=+r(t[o],o,t);return a+(+r(t[o+1],o+1,t)-a)*(i-o)}}function x(t,e){var r,n,i=-1,o=t.length;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n){r=n;break}for(;++i<o;)null!=(n=t[i])&&r>n&&(r=n)}else{for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n){r=n;break}for(;++i<o;)null!=(n=e(t[i],i,t))&&r>n&&(r=n)}return r}function M(t){if(!(i=t.length))return[];for(var e=-1,r=x(t,E),n=new Array(r);++e<r;)for(var i,o=-1,s=n[e]=new Array(i);++o<i;)s[o]=t[o][e];return n}function E(t){return t.length}t.version="0.7.1",t.bisect=i,t.bisectRight=i,t.bisectLeft=o,t.ascending=e,t.bisector=r,t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=l,t.extent=u,t.histogram=function(){var t=f,e=u,r=y;function n(n){var o,s,a=n.length,l=new Array(a);for(o=0;o<a;++o)l[o]=+t(n[o],o,n);var u=e(l),h=+u[0],f=+u[1],c=r(l,h,f);Array.isArray(c)||(c=g(h,f,+c));var m=c.length;for(o=0;o<m;++o)c[o]=+c[o];for(;c[0]<=h;)c.shift(),--m;for(;c[m-1]>=f;)c.pop(),--m;var p,d=new Array(m+1);for(o=0;o<=m;++o)(p=d[o]=[]).x0=o>0?c[o-1]:h,p.x1=o<m?c[o]:f;for(o=0;o<a;++o)h<=(s=l[o])&&s<=f&&d[i(c,s,0,m)].push(n[o]);return d}return n.value=function(e){return arguments.length?(t="function"==typeof e?e:h(+e),n):t},n.domain=function(t){return arguments.length?(e="function"==typeof t?t:h([+t[0],+t[1]]),n):e},n.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?h(Array.prototype.map.call(t,b)):h(+t),n):r},n},t.thresholdFreedmanDiaconis=function(t,r,n){return t.sort(e),Math.ceil((n-r)/(2*(v(t,.75)-v(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,r){return Math.ceil((r-e)/(3.5*l(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=y,t.max=function(t,e){var r,n,i=-1,o=t.length;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n){r=n;break}for(;++i<o;)null!=(n=t[i])&&n>r&&(r=n)}else{for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n){r=n;break}for(;++i<o;)null!=(n=e(t[i],i,t))&&n>r&&(r=n)}return r},t.mean=function(t,e){var r,n=0,i=t.length,o=-1,a=i;if(null==e)for(;++o<i;)isNaN(r=s(t[o]))?--a:n+=r;else for(;++o<i;)isNaN(r=s(e(t[o],o,t)))?--a:n+=r;if(a)return n/a},t.median=function(t,r){var n,i=[],o=t.length,a=-1;if(null==r)for(;++a<o;)isNaN(n=s(t[a]))||i.push(n);else for(;++a<o;)isNaN(n=s(r(t[a],a,t)))||i.push(n);return v(i.sort(e),.5)},t.merge=function(t){for(var e,r,n,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(r=new Array(s);--i>=0;)for(e=(n=t[i]).length;--e>=0;)r[--s]=n[e];return r},t.min=x,t.pairs=function(t){for(var e=0,r=t.length-1,n=t[0],i=new Array(r<0?0:r);e<r;)i[e]=[n,n=t[++e]];return i},t.permute=function(t,e){for(var r=e.length,n=new Array(r);r--;)n[r]=t[e[r]];return n},t.quantile=v,t.range=c,t.scan=function(t,r){if(n=t.length){var n,i,o=0,s=0,a=t[s];for(r||(r=e);++o<n;)(r(i=t[o],a)<0||0!==r(a,a))&&(a=i,s=o);return 0===r(a,a)?s:void 0}},t.shuffle=function(t,e,r){for(var n,i,o=(null==r?t.length:r)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,n=t[o+e],t[o+e]=t[i+e],t[i+e]=n;return t},t.sum=function(t,e){var r,n=0,i=t.length,o=-1;if(null==e)for(;++o<i;)(r=+t[o])&&(n+=r);else for(;++o<i;)(r=+e(t[o],o,t))&&(n+=r);return n},t.ticks=g,t.tickStep=w,t.transpose=M,t.variance=a,t.zip=function(){return M(arguments)}}(e)}));function z(t,e){let r,n=!1;if(Array.isArray(e)){if(t.length!==e.length)throw new Error("sub: size of array1 and array2 must be identical")}else n=!0,r=Number(e);let i=new Array(t.length);if(n)for(let e=0;e<t.length;e++)i[e]=t[e]-r;else for(let r=0;r<t.length;r++)i[r]=t[r]-e[r];return i}function D(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var e=0,r=0;r<t.length;r++)e+=t[r];return e}function j(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.algorithm,s=void 0===i?"absolute":i,a=n.sumValue,l=void 0===a?1:a,u=n.maxValue,h=void 0===u?1:u;if(!r(t))throw new Error("input must be an array");if(void 0!==n.output){if(!r(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);if(0===t.length)throw new Error("input must not be empty");switch(s.toLowerCase()){case"absolute":var f=P(t)/l;if(0===f)return t.slice(0);for(var c=0;c<t.length;c++)e[c]=t[c]/f;return e;case"max":var m=o(t);if(0===m)return t.slice(0);for(var p=h/m,d=0;d<t.length;d++)e[d]=t[d]*p;return e;case"sum":var g=D(t)/l;if(0===g)return t.slice(0);for(var w=0;w<t.length;w++)e[w]=t[w]/g;return e;default:throw new Error("norm: unknown algorithm: ".concat(s))}}function P(t){for(var e=0,r=0;r<t.length;r++)e+=Math.abs(t[r]);return e}function U(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!i(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=s(t),a=o(t);if(n===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var l=r.min,u=void 0===l?r.autoMinMax?n:0:l,h=r.max,f=void 0===h?r.autoMinMax?a:1:h;if(u>=f)throw new RangeError("min option must be smaller than max option");for(var c=(f-u)/(a-n),m=0;m<t.length;m++)e[m]=(t[m]-n)*c+u;return e}function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==$(t)||i(t)||(e=t,t=[]),!i(t))throw new TypeError("input must be an array");var r=e,n=r.from,o=void 0===n?0:n,s=r.to,a=void 0===s?10:s,l=r.size,u=void 0===l?t.length:l,h=r.step;if(u&&h)throw new Error("step is defined by the array size");if(u||(u=h?Math.floor((a-o)/h)+1:a-o+1),!h&&u&&(h=(a-o)/(u-1)),Array.isArray(t)){t.length=0;for(var f=0;f<u;f++)t.push(o),o+=h}else{if(t.length!==u)throw new Error("sequentialFill typed array must have the correct length");for(var c=0;c<u;c++)t[c]=o,o+=h}return t}function q(t=[],e={}){if(0===t.length)return[];let{from:r=Number.NEGATIVE_INFINITY,to:n=Number.POSITIVE_INFINITY}=e;if(r>n&&([r,n]=[n,r]),(t=(t=JSON.parse(JSON.stringify(t)).map(t=>t.from>t.to?{from:t.to,to:t.from}:t)).sort((t,e)=>t.from!==e.from?t.from-e.from:t.to-e.to)).forEach(t=>{r>t.from&&(t.from=r),n<t.to&&(t.to=n)}),0===(t=t.filter(t=>t.from<=t.to)).length)return[];let i=t[0],o=[i];for(let e=1;e<t.length;e++){let r=t[e];r.from<=i.to?i.to=r.to:(i=r,o.push(i))}return o}function V(t,e,r,n){return.5*r*e*e+n*e-(.5*r*t*t+n*t)}function X(t={},e={}){let{x:r,y:n}=t,i=r.length,o=!1;r.length>1&&r[0]>r[1]&&(r=r.slice().reverse(),n=n.slice().reverse(),o=!0);let{from:s=r[0],to:a=r[i-1],variant:l="smooth",numberOfPoints:u=100,exclusions:h=[],zones:f=[]}=e;if(i!==n.length)throw new RangeError("the x and y vector doesn't have the same size.");if("number"!=typeof s||isNaN(s))throw new RangeError("'from' option must be a number");if("number"!=typeof a||isNaN(a))throw new RangeError("'to' option must be a number");if("number"!=typeof u||isNaN(u))throw new RangeError("'numberOfPoints' option must be a number");if(u<2)throw new RangeError("'numberOfPoints' option must be greater than 1");0===f.length&&(f=function(t=[],e={}){let{from:r=Number.NEGATIVE_INFINITY,to:n=Number.POSITIVE_INFINITY}=e;if(r>n&&([r,n]=[n,r]),0===(t=q(t,{from:r,to:n})).length)return[{from:r,to:n}];let i=[];for(let e=0;e<t.length;e++){let o=t[e],s=t[e+1];0===e&&o.from>r&&i.push({from:r,to:o.from}),e===t.length-1?o.to<n&&i.push({from:o.to,to:n}):i.push({from:o.to,to:s.from})}return i}(h,{from:s,to:a})),f=function(t,e,r={}){if(0===t.length)return t;let n=(t=q(t,r)).reduce((t,e)=>t+(e.to-e.from),0)/e,i=0;for(let r=0;r<t.length-1;r++){let o=t[r];o.numberOfPoints=Math.min(Math.round((o.to-o.from)/n),e-i),i+=o.numberOfPoints}return t[t.length-1].numberOfPoints=e-i,t}(f,u,{from:s,to:a});let c=[],m=[];for(let t of f){let e=Y(r,n,t.from,t.to,t.numberOfPoints,l);c=c.concat(e.x),m=m.concat(e.y)}return o?s<a?{x:c.reverse(),y:m.reverse()}:{x:c,y:m}:s<a?{x:c,y:m}:{x:c.reverse(),y:m.reverse()}}function Y(t,e,r,n,i,o){if(i<1)throw new RangeError("the number of points must be at least 1");let s="slot"===o?function(t,e,r,n,i){let o=t.length,s=(n-r)/(i-1),a=s/2,l=t[t.length-1]-t[t.length-2],u=r-a,h=new Array(i),f=u,c=u+s,m=-Number.MAX_VALUE,p=0,d=t[0],g=e[0],w=0,y=!0,b=0,v=0,x=1,M=0;t:for(;;){if(m>=d)throw new Error("x must be an increasing serie");for(;m-c>0;){if(y&&(v++,y=!1),h[M]=v<=0?0:b/v,M++,M===i)break t;f=c,c+=s,b=0,v=0}m>f&&(b+=p,v++),(m===-Number.MAX_VALUE||w>1)&&v--,m=d,p=g,x<o?(d=t[x],g=e[x],x++):(d+=l,g=0,w++)}return h}(t,e,r,n,i):function(t,e,r,n,i){let o=t.length,s=(n-r)/(i-1),a=s/2,l=new Array(i),u=t[1]-t[0],h=t[o-1]-t[o-2],f=r-a,c=r+a,m=Number.MIN_VALUE,p=0,d=t[0]-u,g=0,w=0,y=0,b=0,v=0,x=0,M=0,E=0,S=0;t:for(;;){for(m<=f&&f<=d&&(S=V(0,f-m,y,p),v=w+S);d-c>=0;){if(S=V(0,c-m,y,p),x=w+S,l[E++]=(x-v)/s,E===i)break t;f=c,c+=s,v=x}w+=V(m,d,y,b),m=d,p=g,M<o?(d=t[M],g=e[M],M++):M===o&&(d+=h,g=0),y=(g-p)/(d-m),b=-y*m+p}return l}(t,e,r,n,i);return{x:L({from:r,to:n,size:i}),y:s}}function B(t,e={}){const{x:r,y:n}=t,{from:i=r[0],to:o=r[r.length-1],exclusions:s=[]}=e;let a=function(t,e,r=[]){t>e&&([t,e]=[e,t]),r=r.filter(t=>void 0!==t.from&&void 0!==t.to),(r=JSON.parse(JSON.stringify(r))).forEach(t=>{t.from>t.to&&([t.to,t.from]=[t.from,t.to])}),r.sort((t,e)=>t.from-e.from),r.forEach(r=>{r.from<t&&(r.from=t),r.to>e&&(r.to=e)});for(let t=0;t<r.length-1;t++)r[t].to>r[t+1].from&&(r[t].to=r[t+1].from);if(!(r=r.filter(t=>t.from<t.to))||0===r.length)return[{from:t,to:e}];let n=[],i=t;for(let t of r)i<t.from&&n.push({from:i,to:t.from}),i=t.to;return i<e&&n.push({from:i,to:e}),n}(i,o,s),l=0,u=[],h=[],f=0;for(;f<r.length;){if(r[f]<=a[l].to&&r[f]>=a[l].from)u.push(r[f]),h.push(n[f]);else if(r[f]>a[l].to&&(l++,!a[l]))break;f++}return{x:u,y:h}}const K=" ".repeat(2),W=" ".repeat(4);function H(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:i=8}=e;return`${t.constructor.name} {\n${K}[\n${W}${function(t,e,r,n){const{rows:i,columns:o}=t,s=Math.min(i,e),a=Math.min(o,r),l=[];for(let e=0;e<s;e++){let r=[];for(let i=0;i<a;i++)r.push(G(t.get(e,i),n));l.push(""+r.join(" "))}a!==o&&(l[l.length-1]+=` ... ${o-r} more columns`);s!==i&&l.push(`... ${i-e} more rows`);return l.join("\n"+W)}(t,r,n,i)}\n${K}]\n${K}rows: ${t.rows}\n${K}columns: ${t.columns}\n}`}function G(t,e){const r=String(t);if(r.length<=e)return r.padEnd(e," ");const n=t.toPrecision(e-2);if(n.length<=e)return n;const i=t.toExponential(e-2),o=i.indexOf("e"),s=i.slice(o);return i.slice(0,e-s.length)+s}function Z(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function J(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Q(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function tt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function et(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function rt(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function nt(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(ot("startRow",e),ot("endRow",r),ot("startColumn",n),ot("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function it(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function ot(t,e){if("number"!=typeof e)throw new TypeError(t+" must be a number")}class st{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new lt(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new lt(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new lt(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new lt(t,e)}static ones(t,e){return new lt(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new lt(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let s=i-n,a=new lt(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*s);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new lt(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return st.isMatrix(t)?t:new lt(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(n,i)?o=!0:i++;for(let r=0;r<n;r++){let o=t.get(r,i);for(let s=i;s<e;s++){let e=t.get(r,s)-o*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new lt(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Z(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return lt.rowVector(this.getRow(t))}setRow(t,e){Z(this,t),e=Q(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Z(this,t),Z(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){J(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return lt.columnVector(this.getColumn(t))}setColumn(t,e){J(this,t),e=tt(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){J(this,t),J(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Q(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Q(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Q(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Q(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=tt(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=tt(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=tt(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=tt(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Z(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){J(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){Z(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Z(this,t);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){Z(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Z(this,t);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){J(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){J(this,t);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){J(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){J(this,t);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError("unknown norm type: "+t)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){st.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=lt.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new lt(e,n),o=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)o[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];i.set(t,s,e)}}return i}strassen2x2(t){t=lt.checkMatrix(t);let e=new lt(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),l=this.get(1,1),u=t.get(1,1),h=(r+l)*(n+u),f=(s+l)*n,c=r*(o-u),m=l*(a-n),p=(r+i)*u,d=h+m-p+(i-l)*(a+u),g=c+p,w=f+m,y=h-f+c+(s-r)*(n+o);return e.set(0,0,d),e.set(0,1,g),e.set(1,0,w),e.set(1,1,y),e}strassen3x3(t){t=lt.checkMatrix(t);let e=new lt(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),l=this.get(2,0),u=this.get(2,1),h=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),p=t.get(1,0),d=t.get(1,1),g=t.get(1,2),w=t.get(2,0),y=t.get(2,1),b=t.get(2,2),v=(r-o)*(-c+d),x=(-r+o+s)*(f-c+d),M=(o+s)*(-f+c),E=r*f,S=(-r+l+u)*(f-m+g),k=(-r+l)*(m-g),A=(l+u)*(-f+m),T=(-i+u+h)*(d+w-y),_=(i-h)*(d-y),R=i*w,C=(u+h)*(-w+y),N=(-i+s+a)*(g+w-b),F=(i-a)*(g-b),O=(s+a)*(-w+b),I=E+R+n*p,z=(r+n+i-o-s-u-h)*d+x+M+E+T+R+C,D=E+S+A+(r+n+i-s-a-l-u)*g+R+N+O,j=v+s*(-f+c+p-d-g-w+b)+x+E+R+N+F,P=v+x+M+E+a*y,U=R+N+F+O+o*m,$=E+S+k+u*(-f+m+p-d-g-w+y)+T+_+R,L=T+_+R+C+l*c,q=E+S+k+A+h*b;return e.set(0,0,I),e.set(0,1,z),e.set(0,2,D),e.set(1,0,j),e.set(1,1,P),e.set(1,2,U),e.set(2,0,$),e.set(2,1,L),e.set(2,2,q),e}mmulStrassen(t){t=lt.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,o=t.columns;function s(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=st.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(r,i),l=Math.max(n,o);return e=s(e,a,l),function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=s(e,n+1,i+1),r=s(r,n+1,i+1)):n%2==1?(e=s(e,n+1,i),r=s(r,n+1,i)):i%2==1&&(e=s(e,n,i+1),r=s(r,n,i+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),l=e.subMatrix(0,o-1,0,a-1),u=r.subMatrix(0,o-1,0,a-1),h=e.subMatrix(0,o-1,a,e.columns-1),f=r.subMatrix(0,o-1,a,r.columns-1),c=e.subMatrix(o,e.rows-1,0,a-1),m=r.subMatrix(o,r.rows-1,0,a-1),p=e.subMatrix(o,e.rows-1,a,e.columns-1),d=r.subMatrix(o,r.rows-1,a,r.columns-1),g=t(st.add(l,p),st.add(u,d),o,a),w=t(st.add(c,p),u,o,a),y=t(l,st.sub(f,d),o,a),b=t(p,st.sub(m,u),o,a),v=t(st.add(l,h),d,o,a),x=t(st.sub(c,l),st.add(u,f),o,a),M=t(st.sub(h,p),st.add(m,d),o,a),E=st.add(g,b);E.sub(v),E.add(M);let S=st.add(y,v),k=st.add(w,b),A=st.sub(g,w);A.add(y),A.add(x);let T=st.zeros(2*E.rows,2*E.columns);return T=T.setSubMatrix(E,0,0),T=T.setSubMatrix(S,E.rows,0),T=T.setSubMatrix(k,0,E.columns),T=T.setSubMatrix(A,E.rows,E.columns),T.subMatrix(0,n-1,0,i-1)}(e,t=s(t,a,l),a,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new lt(this.rows,this.columns);for(let t=0;t<this.rows;t++){const i=this.getRow(t);U(i,{min:e,max:r,output:i}),n.setRow(t,i)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new lt(this.rows,this.columns);for(let t=0;t<this.columns;t++){const i=this.getColumn(t);U(i,{min:e,max:r,output:i}),n.setColumn(t,i)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=lt.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new lt(e*n,r*i);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<i;a++)o.set(n*s+r,i*e+a,this.get(s,e)*t.get(r,a));return o}transpose(){let t=new lt(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=at){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=at){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){nt(this,t,e,r,n);let i=new lt(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new lt(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new lt(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){nt(this,e,e+(t=lt.checkMatrix(t)).rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){let r=function(t,e,r){return{row:et(t,e),column:rt(t,r)}}(this,t,e),n=new lt(t.length,e.length);for(let t=0;t<r.row.length;t++){let e=r.row[t];for(let i=0;i<r.column.length;i++){let o=r.column[i];n.set(t,i,this.get(e,o))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new lt(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=it(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=it(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error("invalid option: "+t)}}product(t){switch(t){case"row":return function(t){let e=it(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=it(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error("invalid option: "+t)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: "+t)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<n;s++){let n=0,a=0,l=0;for(let e=0;e<i;e++)l=t.get(s,e)-r[s],n+=l,a+=l*l;e?o.push((a-n*n/i)/(i-1)):o.push((a-n*n/i)/i)}return o}(this,r,n);case"column":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,l=0;for(let e=0;e<n;e++)l=t.get(e,s)-r[s],i+=l,a+=l*l;e?o.push((a-i*i/n)/(n-1)):o.push((a-i*i/n)/n)}return o}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,o=n*i;let s=0,a=0,l=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)l=t.get(e,n)-r,s+=l,a+=l*l;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,r,n);default:throw new Error("invalid option: "+t)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error("invalid option: "+t)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=Math.pow(t.get(i,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error("invalid option: "+t)}}toString(t){return H(this,t)}}function at(t,e){return t-e}st.prototype.klass="Matrix","undefined"!=typeof Symbol&&(st.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return H(this)}),st.random=st.rand,st.randomInt=st.randInt,st.diagonal=st.diag,st.prototype.diagonal=st.prototype.diag,st.identity=st.eye,st.prototype.negate=st.prototype.neg,st.prototype.tensorProduct=st.prototype.kroneckerProduct;class lt extends st{constructor(t,e){if(super(),lt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(this.data=[],!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[n]))}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){if(Z(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Z(this,t,!0),e=Float64Array.from(Q(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(J(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),J(this,t,!0),e=tt(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(st,lt);class ut extends st{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class ht extends ut{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class ft extends st{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class ct{constructor(t){let e,r,n,i,o,s,a,l,u,h=(t=ft.checkMatrix(t)).clone(),f=h.rows,c=h.columns,m=new Float64Array(f),p=1;for(e=0;e<f;e++)m[e]=e;for(l=new Float64Array(f),r=0;r<c;r++){for(e=0;e<f;e++)l[e]=h.get(e,r);for(e=0;e<f;e++){for(u=Math.min(e,r),o=0,n=0;n<u;n++)o+=h.get(e,n)*l[n];l[e]-=o,h.set(e,r,l[e])}for(i=r,e=r+1;e<f;e++)Math.abs(l[e])>Math.abs(l[i])&&(i=e);if(i!==r){for(n=0;n<c;n++)s=h.get(i,n),h.set(i,n,h.get(r,n)),h.set(r,n,s);a=m[i],m[i]=m[r],m[r]=a,p=-p}if(r<f&&0!==h.get(r,r))for(e=r+1;e<f;e++)h.set(e,r,h.get(e,r)/h.get(r,r))}this.LU=h,this.pivotVector=m,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=lt.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i));for(i=a-1;i>=0;i--){for(n=0;n<o;n++)s.set(i,n,s.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new lt(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new lt(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function mt(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class pt{constructor(t){let e,r,n,i,o=(t=ft.checkMatrix(t)).clone(),s=t.rows,a=t.columns,l=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=mt(t,o.get(e,n));if(0!==t){for(o.get(n,n)<0&&(t=-t),e=n;e<s;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}l[n]=-t}this.QR=o,this.Rdiag=l}solve(t){t=lt.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,o,s,a=t.columns,l=t.clone(),u=e.columns;for(o=0;o<u;o++)for(i=0;i<a;i++){for(s=0,n=o;n<r;n++)s+=e.get(n,o)*l.get(n,i);for(s=-s/e.get(o,o),n=o;n<r;n++)l.set(n,i,l.get(n,i)+s*e.get(n,o))}for(o=u-1;o>=0;o--){for(i=0;i<a;i++)l.set(o,i,l.get(o,i)/this.Rdiag[o]);for(n=0;n<o;n++)for(i=0;i<a;i++)l.set(n,i,l.get(n,i)-l.get(o,i)*e.get(n,o))}return l.subMatrix(0,u-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new lt(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new lt(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<o;t++)n+=i.get(t,r)*a.get(t,e);for(n=-n/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*i.get(t,r))}}return a}}class dt{constructor(t,e={}){let r=(t=ft.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;let a,l=Boolean(i),u=Boolean(o),h=!1;if(r<n)if(s){a=t.transpose(),r=a.rows,n=a.columns,h=!0;let e=l;l=u,u=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let f=Math.min(r,n),c=Math.min(r+1,n),m=new Float64Array(c),p=new lt(r,f),d=new lt(n,n),g=new Float64Array(n),w=new Float64Array(r),y=new Float64Array(c);for(let t=0;t<c;t++)y[t]=t;let b=Math.min(r-1,n),v=Math.max(0,Math.min(n-2,r)),x=Math.max(b,v);for(let t=0;t<x;t++){if(t<b){m[t]=0;for(let e=t;e<r;e++)m[t]=mt(m[t],a.get(e,t));if(0!==m[t]){a.get(t,t)<0&&(m[t]=-m[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/m[t]);a.set(t,t,a.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<n;e++){if(t<b&&0!==m[t]){let n=0;for(let i=t;i<r;i++)n+=a.get(i,t)*a.get(i,e);n=-n/a.get(t,t);for(let i=t;i<r;i++)a.set(i,e,a.get(i,e)+n*a.get(i,t))}g[e]=a.get(t,e)}if(l&&t<b)for(let e=t;e<r;e++)p.set(e,t,a.get(e,t));if(t<v){g[t]=0;for(let e=t+1;e<n;e++)g[t]=mt(g[t],g[e]);if(0!==g[t]){g[t+1]<0&&(g[t]=0-g[t]);for(let e=t+1;e<n;e++)g[e]/=g[t];g[t+1]+=1}if(g[t]=-g[t],t+1<r&&0!==g[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)w[e]+=g[r]*a.get(e,r);for(let e=t+1;e<n;e++){let n=-g[e]/g[t+1];for(let i=t+1;i<r;i++)a.set(i,e,a.get(i,e)+n*w[i])}}if(u)for(let e=t+1;e<n;e++)d.set(e,t,g[e])}}let M=Math.min(n,r+1);if(b<n&&(m[b]=a.get(b,b)),r<M&&(m[M-1]=0),v+1<M&&(g[v]=a.get(v,M-1)),g[M-1]=0,l){for(let t=b;t<f;t++){for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<f;e++){let n=0;for(let i=t;i<r;i++)n+=p.get(i,t)*p.get(i,e);n=-n/p.get(t,t);for(let i=t;i<r;i++)p.set(i,e,p.get(i,e)+n*p.get(i,t))}for(let e=t;e<r;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}}if(u)for(let t=n-1;t>=0;t--){if(t<v&&0!==g[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=d.get(i,t)*d.get(i,e);r=-r/d.get(t+1,t);for(let i=t+1;i<n;i++)d.set(i,e,d.get(i,e)+r*d.get(i,t))}for(let e=0;e<n;e++)d.set(e,t,0);d.set(t,t,1)}let E=M-1,S=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(g[t])<=e||Number.isNaN(g[t])){g[t]=0;break}}if(t===M-2)e=4;else{let r;for(r=M-1;r>=t&&r!==t;r--){let e=(r!==M?Math.abs(g[r]):0)+(r!==t+1?Math.abs(g[r-1]):0);if(Math.abs(m[r])<=S*e){m[r]=0;break}}r===t?e=3:r===M-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=g[M-2];g[M-2]=0;for(let r=M-2;r>=t;r--){let i=mt(m[r],e),o=m[r]/i,s=e/i;if(m[r]=i,r!==t&&(e=-s*g[r-1],g[r-1]=o*g[r-1]),u)for(let t=0;t<n;t++)i=o*d.get(t,r)+s*d.get(t,M-1),d.set(t,M-1,-s*d.get(t,r)+o*d.get(t,M-1)),d.set(t,r,i)}break}case 2:{let e=g[t-1];g[t-1]=0;for(let n=t;n<M;n++){let i=mt(m[n],e),o=m[n]/i,s=e/i;if(m[n]=i,e=-s*g[n],g[n]=o*g[n],l)for(let e=0;e<r;e++)i=o*p.get(e,n)+s*p.get(e,t-1),p.set(e,t-1,-s*p.get(e,n)+o*p.get(e,t-1)),p.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(m[M-1]),Math.abs(m[M-2]),Math.abs(g[M-2]),Math.abs(m[t]),Math.abs(g[t])),i=m[M-1]/e,o=m[M-2]/e,s=g[M-2]/e,a=m[t]/e,h=g[t]/e,f=((o+i)*(o-i)+s*s)/2,c=i*s*(i*s);let w=0;0===f&&0===c||(w=f<0?0-Math.sqrt(f*f+c):Math.sqrt(f*f+c),w=c/(f+w));let y=(a+i)*(a-i)+w,b=a*h;for(let e=t;e<M-1;e++){let i=mt(y,b);0===i&&(i=Number.MIN_VALUE);let o=y/i,s=b/i;if(e!==t&&(g[e-1]=i),y=o*m[e]+s*g[e],g[e]=o*g[e]-s*m[e],b=s*m[e+1],m[e+1]=o*m[e+1],u)for(let t=0;t<n;t++)i=o*d.get(t,e)+s*d.get(t,e+1),d.set(t,e+1,-s*d.get(t,e)+o*d.get(t,e+1)),d.set(t,e,i);if(i=mt(y,b),0===i&&(i=Number.MIN_VALUE),o=y/i,s=b/i,m[e]=i,y=o*g[e]+s*m[e+1],m[e+1]=-s*g[e]+o*m[e+1],b=s*g[e+1],g[e+1]=o*g[e+1],l&&e<r-1)for(let t=0;t<r;t++)i=o*p.get(t,e)+s*p.get(t,e+1),p.set(t,e+1,-s*p.get(t,e)+o*p.get(t,e+1)),p.set(t,e,i)}g[M-2]=y;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,u))for(let e=0;e<=E;e++)d.set(e,t,-d.get(e,t));for(;t<E&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,u&&t<n-1)for(let r=0;r<n;r++)e=d.get(r,t+1),d.set(r,t+1,d.get(r,t)),d.set(r,t,e);if(l&&t<r-1)for(let n=0;n<r;n++)e=p.get(n,t+1),p.set(n,t+1,p.get(n,t)),p.set(n,t,e);t++}M--}}if(h){let t=d;d=p,p=t}this.m=r,this.n=n,this.s=m,this.U=p,this.V=d}solve(t){let e=t,r=this.threshold,n=this.s.length,i=lt.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(i),l=s.rows,u=o.rows,h=lt.zeros(l,u);for(let t=0;t<l;t++)for(let e=0;e<u;e++){let r=0;for(let i=0;i<n;i++)r+=a.get(t,i)*o.get(e,i);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(lt.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new lt(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,s=o.rows,a=o.columns,l=new lt(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i.get(t,n)*o.get(e,n);l.set(t,e,r)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return lt.diag(this.s)}}function gt(t,e=!1){return t=ft.checkMatrix(t),e?new dt(t).inverse():function(t,e,r=!1){return t=ft.checkMatrix(t),e=ft.checkMatrix(e),r?new dt(t).solve(e):t.isSquare()?new ct(t).solve(e):new pt(t).solve(e)}(t,lt.eye(t.rows))}var wt={size:1,value:0};var yt=function(t,e){if(e=Object.assign({},wt,e),Array.isArray(t))return Array.isArray(t[0])?function(t,e){throw void 0===e.size[0]&&(e.size=[e.size,e.size,e.size,e.size]),new Error("matrix not supported yet, sorry")}(0,e):function(t,e){var r=t.length;"number"==typeof e.size&&(e.size=[e.size,e.size]);var n,i,o=r+e.size[0]+e.size[1];if(e.output){if(e.output.length!==o)throw new RangeError("Wrong output size");n=e.output}else n=new Array(o);if("circular"===e.value)for(i=0;i<o;i++)i<e.size[0]?n[i]=t[(r-e.size[0]%r+i)%r]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[(i-e.size[0])%r];else if("replicate"===e.value)for(i=0;i<o;i++)i<e.size[0]?n[i]=t[0]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[r-1];else if("symmetric"===e.value){if(e.size[0]>r||e.size[1]>r)throw new RangeError("expanded value should not be bigger than the data length");for(i=0;i<o;i++)i<e.size[0]?n[i]=t[e.size[0]-1-i]:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=t[2*r+e.size[0]-i-1]}else for(i=0;i<o;i++)i<e.size[0]?n[i]=e.value:i<e.size[0]+r?n[i]=t[i-e.size[0]]:n[i]=e.value;return n}(t,e);throw new TypeError("data should be an array")};const bt={windowSize:5,derivative:1,polynomial:2,pad:"none",padValue:"replicate"};function vt(t,e,r){if((r=Object.assign({},bt,r)).windowSize%2==0||r.windowSize<5||!Number.isInteger(r.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(r.derivative<0||!Number.isInteger(r.derivative))throw new RangeError("Derivative should be a positive integer");if(r.polynomial<1||!Number.isInteger(r.polynomial))throw new RangeError("Polynomial should be a positive integer");let n,i,o=Math.floor(r.windowSize/2);"pre"===r.pad&&(t=yt(t,{size:o,value:r.padValue}));let s=new Array(t.length-2*o);if(5!==r.windowSize||2!==r.polynomial||1!==r.derivative&&2!==r.derivative){let t=lt.ones(r.windowSize,r.polynomial+1),e=-(r.windowSize-1)/2;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+1===0&&0===n||t.set(r,n,Math.pow(e+r,n));let o=new ht(t);n=gt(o.mmul(t)).mmul(o),n=n.getRow(r.derivative),i=1/function(t){let e=1;for(;t>0;)e*=t--;return e}(r.derivative)}else 1===r.derivative?(n=[-2,-1,0,1,2],i=10):(n=[2,-1,-2,-1,2],i=7);let a=i*Math.pow(e,r.derivative);for(let e=o;e<t.length-o;e++){let r=0;for(let i=0;i<n.length;i++)r+=n[i]*t[i+e-o]/a;s[e-o]=r}return"post"===r.pad&&(s=yt(s,{size:o,value:r.padValue})),s}var xt=l((function(t,e){function r(t,e){return t-e}e.sum=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e},e.max=function(t){for(var e=t[0],r=t.length,n=1;n<r;n++)t[n]>e&&(e=t[n]);return e},e.min=function(t){for(var e=t[0],r=t.length,n=1;n<r;n++)t[n]<e&&(e=t[n]);return e},e.minMax=function(t){for(var e=t[0],r=t[0],n=t.length,i=1;i<n;i++)t[i]<e&&(e=t[i]),t[i]>r&&(r=t[i]);return{min:e,max:r}},e.arithmeticMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=t[n];return e/r},e.mean=e.arithmeticMean,e.geometricMean=function(t){for(var e=1,r=t.length,n=0;n<r;n++)e*=t[n];return Math.pow(e,1/r)},e.logMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++)e+=Math.log(t[n]);return e/r},e.grandMean=function(t,e){for(var r=0,n=0,i=t.length,o=0;o<i;o++)r+=e[o]*t[o],n+=e[o];return r/n},e.truncatedMean=function(t,e,n){void 0===n&&(n=!1),n||(t=[].concat(t).sort(r));for(var i=t.length,o=Math.floor(i*e),s=0,a=o;a<i-o;a++)s+=t[a];return s/(i-2*o)},e.harmonicMean=function(t){for(var e=0,r=t.length,n=0;n<r;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");e+=1/t[n]}return r/e},e.contraHarmonicMean=function(t){for(var e=0,r=0,n=t.length,i=0;i<n;i++)e+=t[i]*t[i],r+=t[i];if(r<0)throw new RangeError("sum of values is negative");return e/r},e.median=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(r));var n=t.length,i=Math.floor(n/2);return n%2==0?.5*(t[i-1]+t[i]):t[i]},e.variance=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=0,o=t.length,s=0;s<o;s++){var a=t[s]-n;i+=a*a}return r?i/(o-1):i/o},e.standardDeviation=function(t,r){return Math.sqrt(e.variance(t,r))},e.standardError=function(t){return e.standardDeviation(t)/Math.sqrt(t.length)},e.robustMeanAndStdev=function(t){var e=0,n=t.length,i=0;for(i=0;i<n;i++)e+=t[i];e/=n;var o=new Array(n);for(i=0;i<n;i++)o[i]=Math.abs(t[i]-e);return o.sort(r),{mean:e,stdev:n%2==1?o[(n-1)/2]/.6745:.5*(o[n/2]+o[n/2-1])/.6745}},e.quartiles=function(t,n){void 0===n&&(n=!1),n||(t=[].concat(t).sort(r));var i=t.length/4;return{q1:t[Math.ceil(i)-1],q2:e.median(t,!0),q3:t[Math.ceil(3*i)-1]}},e.pooledStandardDeviation=function(t,r){return Math.sqrt(e.pooledVariance(t,r))},e.pooledVariance=function(t,r){void 0===r&&(r=!0);for(var n=0,i=0,o=t.length,s=0;s<o;s++){var a=t[s],l=e.variance(a);n+=(a.length-1)*l,i+=r?a.length-1:a.length}return n/i},e.mode=function(t){var e,r=t.length,n=new Array(r);for(e=0;e<r;e++)n[e]=0;var i=new Array(r),o=0;for(e=0;e<r;e++){var s=i.indexOf(t[e]);s>=0?n[s]++:(i[o]=t[e],n[o]=1,o++)}var a=0,l=0;for(e=0;e<o;e++)n[e]>a&&(a=n[e],l=e);return i[l]},e.covariance=function(t,r,n){void 0===n&&(n=!0);var i=e.mean(t),o=e.mean(r);if(t.length!==r.length)throw"Vectors do not have the same dimensions";for(var s=0,a=t.length,l=0;l<a;l++){s+=(t[l]-i)*(r[l]-o)}return n?s/(a-1):s/a},e.skewness=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=0,o=0,s=t.length,a=0;a<s;a++){var l=t[a]-n;i+=l*l,o+=l*l*l}var u=i/s,h=o/s/Math.pow(u,1.5);return r?Math.sqrt(s*(s-1))/(s-2)*h:h},e.kurtosis=function(t,r){void 0===r&&(r=!0);for(var n=e.mean(t),i=t.length,o=0,s=0,a=0;a<i;a++){var l=t[a]-n;o+=l*l,s+=l*l*l*l}var u=o/i;if(r){var h=o/(i-1);return i*(i+1)/((i-1)*(i-2)*(i-3))*(s/(h*h))-3*((i-1)*(i-1)/((i-2)*(i-3)))}return s/i/(u*u)-3},e.entropy=function(t,e){void 0===e&&(e=0);for(var r=0,n=t.length,i=0;i<n;i++)r+=t[i]*Math.log(t[i]+e);return-r},e.weightedMean=function(t,e){for(var r=0,n=t.length,i=0;i<n;i++)r+=t[i]*e[i];return r},e.weightedStandardDeviation=function(t,r){return Math.sqrt(e.weightedVariance(t,r))},e.weightedVariance=function(t,r){for(var n=e.weightedMean(t,r),i=0,o=t.length,s=0,a=0,l=0;l<o;l++){var u=t[l]-n,h=r[l];i+=h*(u*u),a+=h,s+=h*h}return i*(a/(a*a-s))},e.center=function(t,r){void 0===r&&(r=!1);var n=t;r||(n=[].concat(t));for(var i=e.mean(n),o=n.length,s=0;s<o;s++)n[s]-=i},e.standardize=function(t,r,n){void 0===r&&(r=e.standardDeviation(t)),void 0===n&&(n=!1);for(var i=t.length,o=n?t:new Array(i),s=0;s<i;s++)o[s]=t[s]/r;return o},e.cumulativeSum=function(t){var e=t.length,r=new Array(e);r[0]=t[0];for(var n=1;n<e;n++)r[n]=r[n-1]+t[n];return r}}));var Mt=l((function(t,e){t.exports=function(){function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function r(t){return e(t)}function n(t){return t}function i(t,e){if(e.length!==t.length)return!1;for(var r=0;r<t.length;r++){if(e[r].compareArray&&!e[r].compareArray(t[r]))return!1;if(e[r]!==t[r])return!1}return!0}function o(t,e){Object.keys(e).forEach((function(r){t[r]=e[r]}))}function s(){for(var t=1,e=0,r=0;r<arguments.length;r++){var n=arguments[r];e+=u(n),t*=n}return 0!==e?l(t,e):t}function a(t,e){if(0===e)throw new Error("Divide by zero");var r=Math.pow(10,u(e));return s(t,r/(r*e))}function l(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function u(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function h(){var t;if(!this)return t=Object.create(h.prototype),h.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function f(t,e){throw new h("Incompatible units: "+t+" and "+e)}h.prototype=Object.create(Error.prototype,{constructor:{value:h}});var c={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-9,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},m=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],p=["<1>"];function d(t,e){var n=e[1],i=e[3]||[],o=e[4]||[];if(!r(n))throw new h(t+": Invalid unit definition. 'scalar' must be a number");i.forEach((function(e){if(void 0===c[e])throw new h(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),o.forEach((function(e){if(void 0===c[e])throw new h(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var g={},w={},y={},b={},v={};for(var x in c)if(c.hasOwnProperty(x)){var M=c[x];if("prefix"===M[2]){g[x]=M[1];for(var E=0;E<M[0].length;E++)w[M[0][E]]=x}else{d(x,M),y[x]={scalar:M[1],numerator:M[3],denominator:M[4]};for(var S=0;S<M[0].length;S++)b[M[0][S]]=x}v[x]=M[0][0]}var k=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function A(){if(this.signature)return this.signature;for(var t=T.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function T(){if(!this.isBase())return T.call(this.toBase());for(var t,e,r=new Array(k.length),n=0;n<r.length;n++)r[n]=0;for(var i=0;i<this.numerator.length;i++)(t=c[this.numerator[i]])&&(e=k.indexOf(t[2]))>=0&&(r[e]=r[e]+1);for(var o=0;o<this.denominator.length;o++)(t=c[this.denominator[o]])&&(e=k.indexOf(t[2]))>=0&&(r[e]=r[e]-1);return r}var _=new RegExp("^([+-]?\\s*(?:(?:\\d+(?:\\.\\d+)?)|(?:\\.\\d+))(?:[Ee][+-]?\\d+)?)?\\s*([^/]*)(?:/(.+))?$"),R=new RegExp("([^ \\*\\d]+?)(?:\\^|\\*{2})?(-?[01234](?![a-zA-Z]))"),C=new RegExp("([^ \\*\\d]+?)(?:\\^|\\*{2})?([01234](?![a-zA-Z]))");function N(e){t(e)||(e=e.toString()),e=e.trim();var r=_.exec(e);if(!r)throw new h(e+": Quantity not recognized");var n=r[1];n?(n=n.replace(/\s/g,""),this.scalar=parseFloat(n)):this.scalar=1;for(var i,o,s,a=r[2],l=r[3];r=R.exec(a);){if(i=parseFloat(r[2]),isNaN(i))throw new h("Unit exponent is not a number");if(0===i&&!z.test(r[1]))throw new h("Unit not recognized");o=r[1]+" ",s="";for(var u=0;u<Math.abs(i);u++)s+=o;i>=0?a=a.replace(r[0],s):(l=l?l+s:s,a=a.replace(r[0],""))}for(;r=C.exec(l);){if(i=parseFloat(r[2]),isNaN(i))throw new h("Unit exponent is not a number");if(0===i&&!z.test(r[1]))throw new h("Unit not recognized");o=r[1]+" ",s="";for(var f=0;f<i;f++)s+=o;l=l.replace(r[0],s)}a&&(this.numerator=P(a.trim())),l&&(this.denominator=P(l.trim()))}var F=Object.keys(w).sort((function(t,e){return e.length-t.length})).join("|"),O=Object.keys(b).sort((function(t,e){return e.length-t.length})).join("|"),I="("+F+")??("+O+")(?:\\b|$)",z=new RegExp("^\\s*("+I+"[\\s\\*]*)+$"),D=new RegExp(I,"g"),j={};function P(t){var e=j[t];if(e)return e;var r,n=[];if(!z.test(t))throw new h("Unit not recognized");for(;r=D.exec(t);)n.push(r.slice(1));return n=(n=(n=n.map((function(t){return w[t[0]]?[w[t[0]],b[t[1]]]:[b[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),j[t]=n,n}function U(t){return t instanceof $}function $(t,e){if(L.apply(null,arguments),!U(this))return new $(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=p,this.denominator=p,q(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:p,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:p):e?(N.call(this,e),this.scalar=t):N.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new h("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new h("Cannot multiply by temperatures");if(!i(this.denominator,p))throw new h("Cannot divide with temperatures")}if(this.initValue=t,V.call(this),this.isTemperature()&&this.baseScalar<0)throw new h("Temperatures must not be less than absolute zero")}function L(e,n){if(n){if(!r(e)||!t(n))throw new h("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||r(e)||U(e)||q(e)))throw new h("Only string, number or quantity accepted as single initialization value")}function q(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function V(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=A.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}$.prototype={constructor:$};var X={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function Y(t,e){var r=e.to(B(t.units()));return $({scalar:t.scalar+r.scalar,numerator:t.numerator,denominator:t.denominator})}function B(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new h("Unknown type for temp conversion from: "+t)}function K(t,e){var r,n=function(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar;else if("tempF"===r)e=5*t.scalar/9;else{if("tempR"!==r)throw new h("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return $({scalar:e,numerator:["<kelvin>"],denominator:p})}(t),i=e.units();if("degK"===i)r=n.scalar;else if("degC"===i)r=n.scalar;else if("degF"===i)r=9*n.scalar/5;else{if("degR"!==i)throw new h("Unknown type for degree conversion to: "+i);r=9*n.scalar/5}return $({scalar:r,numerator:e.numerator,denominator:e.denominator})}$.prototype.kind=function(){return X[this.signature.toString()]},o($.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&i(this.denominator,p)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),o($.prototype,{to:function(e){var r,n;return null==e?this:t(e)?(r=this._conversionCache[e])?r:(n=$(e)).units()===this.units()?this:(this.isCompatible(n)?n=n.isTemperature()?function(t,e){var r,n=e.units();if("tempK"===n)r=t.baseScalar;else if("tempC"===n)r=t.baseScalar-273.15;else if("tempF"===n)r=9*t.baseScalar/5-459.67;else{if("tempR"!==n)throw new h("Unknown type for temp conversion to: "+n);r=9*t.baseScalar/5}return $({scalar:r,numerator:e.numerator,denominator:e.denominator})}(this,n):n.isDegrees()?K(this,n):$({scalar:a(this.baseScalar,n.baseScalar),numerator:n.numerator,denominator:n.denominator}):this.isInverse(n)?n=this.inverse().to(e):f(this.units(),n.units()),this._conversionCache[e]=n,n):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return function(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar+273.15;else if("tempF"===r)e=5*(t.scalar+459.67)/9;else{if("tempR"!==r)throw new h("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return $({scalar:e,numerator:["<temp-K>"],denominator:p})}(this);var t=W[this.units()];return t||(t=function(t,e){for(var r,n=[],i=[],o=1,a=0;a<t.length;a++)r=t[a],g[r]?o=s(o,g[r]):y[r]&&(o*=y[r].scalar,y[r].numerator&&n.push(y[r].numerator),y[r].denominator&&i.push(y[r].denominator));for(var l=0;l<e.length;l++)r=e[l],g[r]?o/=g[r]:y[r]&&(o/=y[r].scalar,y[r].numerator&&i.push(y[r].numerator),y[r].denominator&&n.push(y[r].denominator));return n=n.reduce((function(t,e){return t.concat(e)}),[]),i=i.reduce((function(t,e){return t.concat(e)}),[]),$({scalar:o,numerator:n,denominator:i})}(this.numerator,this.denominator),W[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new h("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=$(e)),r(e)&&(e=$(e+" "+this.units())),this.isUnitless()?e.isUnitless()||f(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new h("Divide by zero");return $(s(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var W={};function H(t,e,r,n){function i(t){return"<1>"!==t}t=t.filter(i),r=r.filter(i),e=e.filter(i),n=n.filter(i);var o={};function s(t,e){for(var r,n,i,s=0;s<t.length;s++)if(g[t[s]]?(r=t[s+1],n=t[s],i=g[n],s++):(r=t[s],n=null,i=1),r&&"<1>"!==r)if(o[r]){o[r][0]+=e;var l=o[r][2]?g[o[r][2]]:1;o[r][1===e?3:4]*=a(i,l)}else o[r]=[e,r,n,1,1]}s(t,1),s(e,-1),s(r,1),s(n,-1);var l=[],u=[],h=1;for(var f in o)if(o.hasOwnProperty(f)){var c,m=o[f];if(m[0]>0)for(c=0;c<m[0];c++)l.push(null===m[2]?m[1]:[m[2],m[1]]);else if(m[0]<0)for(c=0;c<-m[0];c++)u.push(null===m[2]?m[1]:[m[2],m[1]]);h*=a(m[3],m[4])}return 0===l.length&&(l=p),0===u.length&&(u=p),[l=l.reduce((function(t,e){return t.concat(e)}),[]),u=u.reduce((function(t,e){return t.concat(e)}),[]),h]}function G(){}$.parse=function(e){if(!t(e))throw new h("Argument should be a string");try{return this(e)}catch(t){return null}},$.getUnits=function(t){var e,r=[],n=Object.keys(c);if(void 0===t)for(e=0;e<n.length;e++)-1===["","prefix"].indexOf(c[n[e]][2])&&r.push(n[e].substr(1,n[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new h("Kind not recognized");for(e=0;e<n.length;e++)c[n[e]][2]===t&&r.push(n[e].substr(1,n[e].length-2))}return r.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))},$.getAliases=function(t){if(!b[t])throw new h("Unit not recognized");return c[b[t]][0]},$.mulSafe=s,$.divSafe=a,$.getKinds=function(){return t=Object.keys(X).map((function(t){return X[t]})),e={},t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}));var t,e},$.swiftConverter=function(t,e){var r,i=$(t),o=$(e);return i.eq(o)?n:(r=i.isTemperature()?function(t){return i.mul(t).to(o).scalar}:function(t){return t*i.baseScalar/o.baseScalar},function(t){var e,n,i;if(Array.isArray(t)){for(n=t.length,i=[],e=0;e<n;e++)i.push(r(t[e]));return i}return r(t)})},$.Error=h,o($.prototype,{add:function(e){if(t(e)&&(e=$(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new h("Cannot add two temperatures");return this.isTemperature()?Y(this,e):e.isTemperature()?Y(e,this):$({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=$(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return o=e,s=(i=this).units(),a=o.to(s),l=$(B(s)),$({scalar:i.scalar-a.scalar,numerator:l.numerator,denominator:l.denominator});if(this.isTemperature())return r=this,n=e.to(B(r.units())),$({scalar:r.scalar-n.scalar,numerator:r.numerator,denominator:r.denominator});if(e.isTemperature())throw new h("Cannot subtract a temperature from a differential degree unit");var r,n,i,o,s,a,l;return $({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(r(e))return $({scalar:s(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=$(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new h("Cannot multiply by temperatures");var n=e;this.isCompatible(n)&&400!==this.signature&&(n=n.to(this));var i=H(this.numerator,this.denominator,n.numerator,n.denominator);return $({scalar:s(this.scalar,n.scalar,i[2]),numerator:i[0],denominator:i[1]})},div:function(e){if(r(e)){if(0===e)throw new h("Divide by zero");return $({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=$(e)),0===e.scalar)throw new h("Divide by zero");if(e.isTemperature())throw new h("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new h("Cannot divide with temperatures");var n=e;this.isCompatible(n)&&400!==this.signature&&(n=n.to(this));var i=H(this.numerator,this.denominator,n.denominator,n.numerator);return $({scalar:s(this.scalar,i[2])/n.scalar,numerator:i[0],denominator:i[1]})},inverse:function(){if(this.isTemperature())throw new h("Cannot divide with temperatures");if(0===this.scalar)throw new h("Divide by zero");return $({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),o($.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo($(e)):(this.isCompatible(e)||f(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),o($.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return i(t,p)}))},isCompatible:function(e){return t(e)?this.isCompatible($(e)):!!U(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){"<1>"!==t&&-1===m.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),G.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,r,n){if(e){var i=e[r];return n===t.length-1?i?i.data:void 0:i}}),this)},G.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(r,n,i){var o=r[n];return void 0===o&&(o=r[n]={}),i===t.length-1?(o.data=e,e):o}),this)},$.formatter=function(t,e){return(t+" "+e).trim()},o($.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=i(this.numerator,p),e=i(this.denominator,p);if(t&&e)return this._units="",this._units;var r=J(this.numerator),n=J(this.denominator);return this._units=r+(e?"":"/"+n),this._units},toString:function(e,n){var i;if(r(e))i=this.units(),n=e;else if(t(e))i=e;else if(U(e))return this.toPrec(e).toString(n);var o=this.to(i);return o=((void 0!==n?l(o.scalar,n):o.scalar)+" "+o.units()).trim()},format:function(t,e){1===arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||$.formatter;var r=this.to(t);return e.call(this,r.scalar,r.units())}});var Z=new G;function J(t){var e=Z.get(t);return e||(e=i(t,p)?"1":function(t){return t.reduce((function(t,e){var r=t[e];return r||t.push(r=t[e]=[e,0]),r[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}(function(t){for(var e,r,n=[],i=0;i<t.length;i++)e=t[i],r=t[i+1],g[e]?(n.push(v[e]+v[r]),i++):n.push(v[e]);return n}(t)).join("*"),Z.set(t,e),e)}return $.version="1.7.5",$}()}));function Et(t,e,r){if((e=St(e))===(r=St(r)))return t;try{return Mt.swiftConverter(e,r)(t)}catch(t){return}}function St(t){return t=(t=(t=t.replace(/C/g,"tempC")).replace(/F/g,"tempF")).replace(/(^|\W)K(\W|$)/g,"$1tempK$2")}function kt(t,e){const r=t.units!==e?Et(Array.from(t.data),t.units,e):t.data;return{units:e,label:t.label.replace(`[${t.units}]`,`[${e}]`),data:r,min:s(r),max:o(r),isMonotone:p(r)}}class At{constructor(t={}){this.id=t.id||Math.random().toString(36).substring(2,10),this.label=t.label||this.id,this.spectra=[],this.cache={}}pushSpectrum(t,e={}){this.spectra.push(function(t,e={}){let{meta:n={},dataType:i="",title:a=""}=e,l=t.x,u=t.y;if(!l||!u)throw Error("A spectrum must contain at least x and y variables");if(!r(l.data)||!r(u.data))throw Error("x and y variables must contain an array data");let h=l.data,f=h&&h.length>1&&h[0]>h[h.length-1];for(let e in t){let r=t[e];f&&(r.data=r.data.reverse()),r.label=r.label||e,r.units=r.units||r.label.replace(/^.*[([](.*)[)\]].*$/,"$1"),r.min=s(r.data),r.max=o(r.data),r.isMonotone=p(r.data)}return{variables:t,title:a,dataType:i,meta:n}}(t,e)),this.cache={}}getXYSpectrum(t={}){let e=JSON.stringify(t);return this.cache[e]||(this.cache[e]=function(t=[],e={}){if(!(t.length<1))for(let r of t){let t,n,{xUnits:i,yUnits:o,units:s}=e;!s||i||o||([o,i]=s.split(/\s+vs\s+/));let a=Object.keys(r.variables);if(!(!a.length>1)){if(void 0===i)t=r.variables[a[0]];else for(let e in r.variables){if(Et(1,r.variables[e].units,i)){t=kt(r.variables[e],i);break}}if(void 0===o)n=r.variables[a[1]];else for(let t in r.variables){if(Et(1,r.variables[t].units,o)){n=kt(r.variables[t],o);break}}if(t&&n)return{title:r.title,dataType:r.dataType,meta:r.meta,variables:{x:t,y:n}}}}}(this.spectra,t)),this.cache[e]}getNormalizedSpectrum(t={}){const{normalization:e,selector:r}=t,n=this.getXYSpectrum(r);if(n)return function(t,e={}){let r={x:t.variables.x.data,y:t.variables.y.data},n={variables:{x:{data:t.variables.x.data,units:t.variables.x.units,label:t.variables.x.label},y:{data:t.variables.y.data,units:t.variables.y.units,label:t.variables.y.label}}};t.title&&(n.title=t.title),t.dataType&&(n.dataType=t.dataType),t.meta&&(n.meta=t.meta);let{from:i=t.variables.x.min,to:a=t.variables.x.max,numberOfPoints:l,filters:u=[],exclusions:h=[],processing:d=""}=e,{x:g,y:w}=B(r,{from:i,to:a});switch(d){case"firstDerivative":e.processing&&(n.variables.y.units="",n.variables.y.label=n.variables.y.label&&"1 derivative of"+n.variables.y.label.replace(/\s*\[.*\]/,""),w=vt(w,1,{derivative:1,polynomial:2,windowSize:5}),g=g.slice(2,g.length-2));break;case"secondDerivative":e.processing&&(n.variables.y.units="",n.variables.y.label=n.variables.y.label&&"2 derivative of"+n.variables.y.label.replace(/\s*\[.*\]/,""),w=vt(w,1,{derivative:2,polynomial:2,windowSize:5}),g=g.slice(2,g.length-2))}u.length&&(n.variables.y.units="",n.variables.y.label=n.variables.y.label&&n.variables.y.label.replace(/\s*\[.*\]/,""));for(let t of u){let e=t.options||{};switch(t.name.toLowerCase()){case"centermean":w=z(w,xt.mean(w));break;case"dividebysd":w=m(w,xt.standardDeviation(w));break;case"normalize":w=j(w,{sumValue:e.value?Number(e.value):1,algorithm:"absolute"});break;case"rescale":w=U(w,{min:e.min?Number(e.min):0,max:e.max?Number(e.max):1});break;case"dividebymax":w=m(w,o(w));break;case"multiply":w=c(w,e.value?Number(e.value):1);break;case"add":w=f(w,e.value?Number(e.value):0);break;case"":case void 0:break;default:throw new Error("Unknown process kind: "+process.kind)}}return r=l?X({x:g,y:w},{from:i,to:a,numberOfPoints:l,exclusions:h}):B({x:g,y:w},{from:i,to:a,exclusions:h}),n.variables.x.data=g,n.variables.x.min=s(g),n.variables.x.max=o(g),n.variables.x.isMonotone=p(g),n.variables.y.data=w,n.variables.y.min=s(w),n.variables.y.max=o(w),n.variables.y.isMonotone=p(w),n}(n,e)}getXLabel(t){return this.getXYSpectrum(t).variables.x.label}getYLabel(t){return this.getXYSpectrum(t).variables.y.label}}const Tt=["TIC",".RIC","SCANNUMBER"];function _t(t){let e=t.spectra,r=e.length,n={times:new Array(r),series:{ms:{dimension:2,data:new Array(r)}}},i=[];for(let t=0;t<Tt.length;t++){let o=Ct(Tt[t]);e[0][o]&&(i.push(o),n.series[o]={dimension:1,data:new Array(r)})}for(let t=0;t<r;t++){let r=e[t];n.times[t]=r.pageValue;for(let e=0;e<i.length;e++)n.series[i[e]].data[t]=parseFloat(r[i[e]]);r.data&&(n.series.ms.data[t]=[r.data.x,r.data.y])}t.chromatogram=n}function Rt(t){return-1!==Tt.indexOf(t)}function Ct(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"")}function Nt(t){let e=[];for(let r=0;r<t.length;r++)e.push(parseFloat(t[r]));return e}function Ft(t,e){let r=t.yFactor,n=t.deltaX;t.isXYdata=!0;let i={x:[],y:[]};t.data=i;let o,s=t.firstX,a=t.firstY,l=!1,u=0;for(;u<e.length;u++)if(o=e.charCodeAt(u),13===o||10===o)l=!0;else if(l)break;let h=!0,f=!1,c=!1,m=0,p=!1,d=!1,g=0,w=0,y=!1,b=!1,v=!1,x=0;for(;u<=e.length;u++)if(o=u===e.length?13:e.charCodeAt(u),d)13!==o&&10!==o||(h=!0,d=!1);else if(o<=57&&o>=48)b=!0,x>0?g+=(o-48)/Math.pow(10,x++):(g*=10,g+=o-48);else if(44===o||46===o)b=!0,x++;else{if(b){if(h)h=!1,c&&(v=!0);else if(v)v=!1;else{f?(m=y?0-g:g,c=!0,f=!1):p||(w=y?0-g:g);let t=p?g-1:1;for(let e=0;e<t;e++)c?a+=m:a=w,i.x.push(s),i.y.push(a*r),s+=n}y=!1,g=0,x=0,b=!1,p=!1}if(o<74&&o>63)b=!0,c=!1,g=o-64;else if(o>96&&o<106)b=!0,c=!1,g=o-96,y=!0;else if(115===o)b=!0,p=!0,g=9;else if(o>82&&o<91)b=!0,p=!0,g=o-82;else if(o>73&&o<83)b=!0,f=!0,g=o-73;else if(o>105&&o<115)b=!0,f=!0,g=o-105,y=!0;else if(36===o&&36===e.charCodeAt(u+1))b=!0,d=!0;else if(37===o)b=!0,f=!0,g=0,y=!1;else if(45===o){let t=e.charCodeAt(u+1);(t>=48&&t<=57||44===t||46===t)&&(b=!0,h||(c=!1),y=!0)}else 13!==o&&10!==o||(h=!0,d=!1)}}const Ot=/\$\$.*/,It=/[,\t ]+/;function zt(t,e,r){if(t.isPeaktable=!0,t.variables&&2!==Object.keys(t.variables)?function(t,e,r){let n={},i=Object.keys(t.variables),o=i.length;i.forEach(t=>n[t]=[]),t.data=n;let s=e.split(/,? *,?[;\r\n]+ */);for(let t=1;t<s.length;t++){let e=s[t].trim().replace(Ot,"").split(It);if(e.length%o==0)for(let t=0;t<e.length;t++)n[i[t%o]].push(parseFloat(e[t]));else r.logs.push("Format error: "+e)}}(t,e,r):function(t,e,r){let n={x:[],y:[]};t.data=n;let i=e.split(/,? *,?[;\r\n]+ */);for(let e=1;e<i.length;e++){let o=i[e].trim().replace(Ot,"").split(It);if(o.length%2==0)for(let e=0;e<o.length;e+=2)n.x.push(parseFloat(o[e])*t.xFactor),n.y.push(parseFloat(o[e+1])*t.yFactor);else r.logs.push("Format error: "+o)}}(t,e,r),t.variables)for(let e in t.variables)t.variables[e].data=t.data[e]}function Dt(t,e){let r,n=/(\(+|\)+|<+|>+|\s+)/g;t.isXYAdata=!0;let i={x:[],y:[]};t.data=i;let o=e.split(/,? *,?[;\r\n]+ */);for(let t=1;t<o.length;t++)r=o[t].trim().replace(n,"").split(","),i.x.push(parseFloat(r[0])),i.y.push(parseFloat(r[1]))}function jt(t,e){let r=function(t){let e=t[0].data.y[0],r=e,n=t.length,i=t[0].data.x.length,o=new Array(n);for(let s=0;s<n;s++){o[s]=t[s].data.y;for(let t=0;t<i;t++){let n=o[s][t];n<e&&(e=n),n>r&&(r=n)}}const s=t[0].data.x[0],a=t[0].data.x[t[0].data.x.length-1],l=t[0].pageValue,u=t[n-1].pageValue;if(s>a)for(let t of o)t.reverse();return l>u&&o.reverse(),{z:o,minX:Math.min(s,a),maxX:Math.max(s,a),minY:Math.min(l,u),maxY:Math.max(l,u),minZ:e,maxZ:r,noise:h(o[0].map(Math.abs))}}(t.spectra);e.noContour||(t.contourLines=function(t,e){let r,n,i,o,s,a,l,u,h,f,c,m,p,d=t.noise,g=t.z,w=g.length,y=g[0].length,b=t.minX,v=(t.maxX-b)/(y-1),x=t.minY,M=(t.maxY-x)/(w-1),E=t.minZ,S=t.maxZ,k=2*e.nbContourLevels,A=new Array(k);for(let t=0;t<k;t++){let k={};A[t]=k;let T=t%2,_=(S-e.noiseMultiplier*d)*Math.exp((t>>1)-e.nbContourLevels);p=0===T?_+e.noiseMultiplier*d:0-_-e.noiseMultiplier*d;let R=[];if(k.zValue=p,k.lines=R,!(p<=E||p>=S))for(let t=0;t<w-1;t++){let e=g[t],d=g[t+1];for(let g=0;g<y-1;g++)r=e[g],n=e[g+1],i=d[g],o=d[g+1],s=r>p,a=n>p,l=i>p,u=o>p,s!==a&&s!==l&&(h=g+(p-r)/(n-r),f=t,c=g,m=t+(p-r)/(i-r),R.push(h*v+b),R.push(f*M+x),R.push(c*v+b),R.push(m*M+x)),u!==a&&u!==l&&(h=g+1,f=t+1-(p-o)/(n-o),c=g+1-(p-o)/(i-o),m=t+1,R.push(h*v+b),R.push(f*M+x),R.push(c*v+b),R.push(m*M+x)),a!==l&&(h=(g+1-(p-n)/(i-n))*v+b,f=(t+(p-n)/(i-n))*M+x,a!==s&&(c=g+1-(p-n)/(r-n),m=t,R.push(h),R.push(f),R.push(c*v+b),R.push(m*M+x)),l!==s&&(c=g,m=t+1-(p-i)/(r-i),R.push(h),R.push(f),R.push(c*v+b),R.push(m*M+x)),a!==u&&(c=g+1,m=t+(p-n)/(o-n),R.push(h),R.push(f),R.push(c*v+b),R.push(m*M+x)),l!==u&&(c=g+(p-i)/(o-i),m=t+1,R.push(h),R.push(f),R.push(c*v+b),R.push(m*M+x)))}}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,segments:A}}(r,e),delete r.z),t.minMax=r}l((function(t,e){(function(){var t,r="0.3.0",n="2013-03";(t=e).toString=function(){return"version "+r+", released "+n};for(var i=0,o=null,s=null,a={init:function(t){if(0===t||0!=(t&t-1))throw new Error("init: radix-2 required");i=t,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable()},fft1d:function(t,e){a.fft(t,e,1)},ifft1d:function(t,e){var r=1/i;a.fft(t,e,-1);for(var n=0;n<i;n++)t[n]*=r,e[n]*=r},bt1d:function(t,e){a.fft(t,e,-1)},fft2d:function(t,e){for(var r=[],n=[],o=0,s=0;s<i;s++){o=s*i;for(var l=0;l<i;l++)r[l]=t[l+o],n[l]=e[l+o];a.fft1d(r,n);for(var u=0;u<i;u++)t[u+o]=r[u],e[u+o]=n[u]}for(var h=0;h<i;h++){for(var f=0;f<i;f++)o=h+f*i,r[f]=t[o],n[f]=e[o];a.fft1d(r,n);for(var c=0;c<i;c++)t[o=h+c*i]=r[c],e[o]=n[c]}},ifft2d:function(t,e){for(var r=[],n=[],o=0,s=0;s<i;s++){o=s*i;for(var l=0;l<i;l++)r[l]=t[l+o],n[l]=e[l+o];a.ifft1d(r,n);for(var u=0;u<i;u++)t[u+o]=r[u],e[u+o]=n[u]}for(var h=0;h<i;h++){for(var f=0;f<i;f++)o=h+f*i,r[f]=t[o],n[f]=e[o];a.ifft1d(r,n);for(var c=0;c<i;c++)t[o=h+c*i]=r[c],e[o]=n[c]}},fft:function(t,e,r){for(var n,a,l,u,h,f,c,m,p,d=i>>2,g=0;g<i;g++)g<(u=o[g])&&(h=t[g],t[g]=t[u],t[u]=h,h=e[g],e[g]=e[u],e[u]=h);for(var w=1;w<i;w<<=1){a=0,n=i/(w<<1);for(var y=0;y<w;y++){f=s[a+d],c=r*s[a];for(var b=y;b<i;b+=w<<1)m=f*t[l=b+w]+c*e[l],p=f*e[l]-c*t[l],t[l]=t[b]-m,t[b]+=m,e[l]=e[b]-p,e[b]+=p;a+=n}}},_initArray:function(){o="undefined"!=typeof Uint32Array?new Uint32Array(i):[],s="undefined"!=typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;for(o[0]=0;++t<i;){for(r=i>>1;r<=e;)e-=r,r>>=1;e+=r,o[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,r=i>>3,n=t+e,o=Math.sin(Math.PI/i),a=2*o*o,l=Math.sqrt(a*(2-a)),u=s[e]=1,h=s[0]=0;o=2*a;for(var f=1;f<r;f++)a+=o*(u-=a),l-=o*(h+=l),s[f]=h,s[e-f]=u;0!==r&&(s[r]=Math.sqrt(.5));for(var c=0;c<e;c++)s[t-c]=s[c];for(var m=0;m<n;m++)s[m+t]=-s[m]}},l=["init","fft1d","ifft1d","fft2d","ifft2d"],u=0;u<l.length;u++)t[l[u]]=a[l[u]];return t.bt=a.bt1d,t.fft=a.fft1d,t.ifft=a.ifft1d,t}).call(a)}));const Pt={"1H":267522187.44,"2H":41065e3,"3H":285350800,"3He":-203789e3,"7Li":103962e3,"13C":67282840,"14N":19331e3,"15N":-27116e3,"17O":-36264e3,"19F":251662e3,"23Na":70761e3,"27Al":69763e3,"29Si":-5319e4,"31P":108291e3,"57Fe":8681e3,"63Cu":71118e3,"67Zn":16767e3,"129Xe":-73997e3};function Ut(t,e,r){t.profiling&&t.profiling.push({action:e,time:Date.now()-r.start})}function $t(t){let e=t.spectra[0].data;t.chromatogram={times:e.x.slice(),series:{intensity:{dimension:1,data:e.y.slice()}}}}function Lt(t,e,r){!function(t){let e=0,r=0;for(let n of t)for(let t of n.spectra){if(n.ntuples&&n.ntuples.symbol?(!e&&t.observeFrequency&&(e=t.observeFrequency),!r&&t.shiftOffsetVal&&(r=t.shiftOffsetVal)):(e=t.observeFrequency,r=t.shiftOffsetVal),e&&t.xUnits&&t.xUnits.toUpperCase().includes("HZ")){t.xUnits="PPM",t.xFactor=t.xFactor/e,t.firstX=t.firstX/e,t.lastX=t.lastX/e,t.deltaX=t.deltaX/e;for(let r=0;r<t.data.x.length;r++)t.data.x[r]/=e}if(r){let e=t.firstX-r;t.firstX=t.firstX-e,t.lastX=t.lastX-e;for(let r=0;r<t.data.x.length;r++)t.data.x[r]-=e}if(e&&n.ntuples&&n.ntuples.symbol&&n.ntuples.nucleus){let r="",i=n.ntuples.symbol.indexOf(t.pageSymbol);if(n.ntuples.units&&n.ntuples.units[i]&&(r=n.ntuples.units[i]),"PPM"!==r){if(0!==i)throw Error("Not sure about this ntuples format");let r=Pt[n.ntuples.nucleus[0]],o=Pt[n.ntuples.nucleus[1]];if(!r||!o)throw Error("Problem with determination of gyromagnetic ratio");let s=r/o*e;t.pageValue/=s}}}}(t);for(let n of t){if(Object.keys(n.ntuples).length>0){let t=[],e=Object.keys(n.ntuples);for(let r=0;r<e.length;r++){let i=e[r],o=n.ntuples[i];for(let e=0;e<o.length;e++)t[e]||(t[e]={}),t[e][i]=o[e]}n.ntuples=t}n.twoD&&r.wantXY&&(jt(n,r),Ut(e,"Finished countour plot calculation",r),r.keepSpectra||delete n.spectra),r.chromatogram&&(n.spectra.length>1?_t(n):$t(n),Ut(e,"Finished chromatogram calculation",r))}}function qt(t,e,r){let n=-1,i=-1,o="",s="";if(r.indexOf("++")>0)o=r.replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),s=r.replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");else{o=(r=r.replace(/[^a-zA-Z]/g,"")).charAt(0),s=r.charAt(1),e.variables={};for(let n of r){let r=n.toLowerCase(),i=t.ntuples.symbol.indexOf(n);if(-1===i)throw Error("Symbol undefined: "+n);e.variables[r]={};for(let n in t.ntuples)t.ntuples[n][i]&&(e.variables[r][n.replace(/^var/,"")]=t.ntuples[n][i])}}n=t.ntuples.symbol.indexOf(o),i=t.ntuples.symbol.indexOf(s),-1===n&&(n=0),-1===i&&(i=0),t.ntuples.first&&(t.ntuples.first.length>n&&(e.firstX=t.ntuples.first[n]),t.ntuples.first.length>i&&(e.firstY=t.ntuples.first[i])),t.ntuples.last&&(t.ntuples.last.length>n&&(e.lastX=t.ntuples.last[n]),t.ntuples.last.length>i&&(e.lastY=t.ntuples.last[i])),t.ntuples.vardim&&t.ntuples.vardim.length>n&&(e.nbPoints=t.ntuples.vardim[n]),t.ntuples.factor&&(t.ntuples.factor.length>n&&(e.xFactor=t.ntuples.factor[n]),t.ntuples.factor.length>i&&(e.yFactor=t.ntuples.factor[i])),t.ntuples.units&&(t.ntuples.units.length>n&&(t.ntuples.varname&&t.ntuples.varname[n]?e.xUnits=`${t.ntuples.varname[n]} [${t.ntuples.units[n]}]`:e.xUnits=t.ntuples.units[n]),t.ntuples.units.length>i&&(t.ntuples.varname&&t.ntuples.varname[i]?e.yUnits=`${t.ntuples.varname[i]} [${t.ntuples.units[i]}]`:e.yUnits=t.ntuples.units[i]))}function Vt(t){t.xFactor||(t.xFactor=1),t.yFactor||(t.yFactor=1)}const Xt=/[ \t]*,[ \t]*/;class Yt{}const Bt={keepRecordsRegExp:/^$/,canonicDataLabels:!0,canonicMetadataLabels:!1,dynamicTyping:!0,withoutXY:!1,chromatogram:!1,keepSpectra:!1,noContour:!1,nbContourLevels:7,noiseMultiplier:5,profiling:!1};function Kt(t,e,r={}){const{color:n="darkgrey"}=r;t.style=[{name:"unselected",style:{line:{color:n,width:1,dash:1}}},{name:"selected",style:{line:{color:n,width:3,dash:1}}}],t.name=e.label||e.id}const Wt=["#FFB300","#803E75","#FF6800","#A6BDD7","#C10020","#CEA262","#817066","#007D34","#F6768E","#00538A","#FF7A5C","#53377A","#FF8E00","#B32851","#F4C800","#7F180D","#93AA00","#593315","#F13A13","#232C16"];function Ht(t={},e={}){const{info:r,meta:n,forceNtuples:i}=e;let a={info:r,meta:n},l=Object.keys(t).map(t=>t.toLowerCase());if(2===l.length&&l.includes("x")&&l.includes("y")&&!i){let e=t.x,r=e.label||e.name||"x";a.info.xUnits=r.includes(t.x.units)?r:`${r} [${t.x.units}]`;let n=t.y,i=n.label||n.name||"y";return a.info.yUnits=i.includes(t.y.units)?i:`${i} [${t.y.units}]`,function(t,e={}){const{meta:r={},info:n={}}=e,{title:i="",owner:o="",origin:s="",dataType:a="",xUnits:l="",yUnits:u=""}=n;let h=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,p=[];for(let e=0;e<t.x.length;e++){let r=t.x[e],n=t.y[e];h>r&&(h=r),f<r&&(f=r),c>n&&(c=n),m<n&&(m=n),p.push(`${r} ${n}`)}let d=`##TITLE=${i}\n##JCAMP-DX=4.24\n##DATA TYPE=${a}\n##ORIGIN=${s}\n##OWNER=${o}\n##XUNITS=${l}\n##YUNITS=${u}\n##FIRSTX=${h}\n##LASTX=${f}\n##FIRSTY=${c}\n##LASTY=${m}\n`;for(const t of Object.keys(r))d+=`##$${t}=${r[t]}\n`;return`${d}##NPOINTS=${p.length}\n##PEAK TABLE=(XY..XY)\n${p.join("\n")}\n##END`}({x:t.x.data,y:t.y.data},a)}return function(t,e){const{meta:r={},info:n={}}=e,{title:i="",owner:a="",origin:l="",dataType:u=""}=n,h=[],f=[],c=[],m=[],p=[],d=[],g=[],w=[],y=[],b=Object.keys(t);for(let e=0;e<b.length;e++){const r=b[e];let n=t[r],i=n.label&&n.label.replace(/ *\[.*/,""),a=n.label&&n.label.replace(/.*\[(.*)\].*/,"$1");h.push(n.symbol||r),f.push(n.name||i||r),m.push(t[r].data.length),c.push(n.type?n.type.toUpperCase():0===e?"INDEPENDENT":"DEPENDENT"),p.push(n.units||a||""),d.push(t[r][0]),g.push(t[r][t[r].length-1]),w.push(s(t[r].data)),y.push(o(t[r].data))}let v=`##TITLE=${i}\n##JCAMP-DX=6.00\n##DATA TYPE=${u}\n##ORIGIN=${l}\n##OWNER=${a}\n`;for(const t of Object.keys(r))v+=`##$${t}=${r[t]}\n`;v+=`##NTUPLES= ${u}\n##VAR_NAME=  ${f.join()}\n##SYMBOL=    ${h.join()}\n##VAR_TYPE=  ${c.join()}\n##VAR_DIM=   ${m.join()}\n##UNITS=     ${p.join()}\n##PAGE= N=1\n`,v+=`##DATA TABLE= (${h.join("")}..${h.join("")}), PEAKS\n`;for(let e=0;e<t[b[0]].data.length;e++){let r=[];for(let n of b)r.push(t[n].data[e]);v+=r.join("\t")+"\n"}return v+="##END",v}(t,e)}function Gt(t,e){const{info:r={},meta:n={}}=e;let i={options:{},info:{title:t.title,dataType:t.dataType,...r},meta:{...t.meta,...n}};return Ht(t.variables,i)}function Zt(t){return t.replace(/^[ \t]*(.*?)[ \t]*$/,"$1")}var Jt=l((function(t,e){
/* @license
    Papa Parse
    v5.2.0
    https://github.com/mholt/PapaParse
    License: MIT
    */
t.exports=function t(){var e="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{},r=!e.document&&!!e.postMessage,n=r&&/blob:/i.test((e.location||{}).protocol),i={},o=0,s={parse:function(r,n){var a=(n=n||{}).dynamicTyping||!1;if(x(a)&&(n.dynamicTypingFunction=a,a={}),n.dynamicTyping=a,n.transform=!!x(n.transform)&&n.transform,n.worker&&s.WORKERS_SUPPORTED){var l=function(){if(!s.WORKERS_SUPPORTED)return!1;var r,n,a=(r=e.URL||e.webkitURL||null,n=t.toString(),s.BLOB_URL||(s.BLOB_URL=r.createObjectURL(new Blob(["(",n,")();"],{type:"text/javascript"})))),l=new e.Worker(a);return l.onmessage=g,l.id=o++,i[l.id]=l}();return l.userStep=n.step,l.userChunk=n.chunk,l.userComplete=n.complete,l.userError=n.error,n.step=x(n.step),n.chunk=x(n.chunk),n.complete=x(n.complete),n.error=x(n.error),delete n.worker,void l.postMessage({input:r,config:n,workerId:l.id})}var m=null;return"string"==typeof r?m=n.download?new u(n):new f(n):!0===r.readable&&x(r.read)&&x(r.on)?m=new c(n):(e.File&&r instanceof File||r instanceof Object)&&(m=new h(n)),m.stream(r)},unparse:function(t,e){var r=!1,n=!0,i=",",o="\r\n",a='"',l=a+a,u=!1,h=null;!function(){if("object"==typeof e){if("string"!=typeof e.delimiter||s.BAD_DELIMITERS.filter((function(t){return-1!==e.delimiter.indexOf(t)})).length||(i=e.delimiter),("boolean"==typeof e.quotes||"function"==typeof e.quotes||Array.isArray(e.quotes))&&(r=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(u=e.skipEmptyLines),"string"==typeof e.newline&&(o=e.newline),"string"==typeof e.quoteChar&&(a=e.quoteChar),"boolean"==typeof e.header&&(n=e.header),Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");h=e.columns}void 0!==e.escapeChar&&(l=e.escapeChar+a)}}();var f=new RegExp(p(a),"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return m(null,t,u);if("object"==typeof t[0])return m(h||c(t[0]),t,u)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:c(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),m(t.fields||[],t.data||[],u);throw new Error("Unable to serialize unrecognized input");function c(t){if("object"!=typeof t)return[];var e=[];for(var r in t)e.push(r);return e}function m(t,e,r){var s="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var a=Array.isArray(t)&&0<t.length,l=!Array.isArray(e[0]);if(a&&n){for(var u=0;u<t.length;u++)0<u&&(s+=i),s+=d(t[u],u);0<e.length&&(s+=o)}for(var h=0;h<e.length;h++){var f=a?t.length:e[h].length,c=!1,m=a?0===Object.keys(e[h]).length:0===e[h].length;if(r&&!a&&(c="greedy"===r?""===e[h].join("").trim():1===e[h].length&&0===e[h][0].length),"greedy"===r&&a){for(var p=[],g=0;g<f;g++){var w=l?t[g]:g;p.push(e[h][w])}c=""===p.join("").trim()}if(!c){for(var y=0;y<f;y++){0<y&&!m&&(s+=i);var b=a&&l?t[y]:y;s+=d(e[h][b],y)}h<e.length-1&&(!r||0<f&&!m)&&(s+=o)}}return s}function d(t,e){if(null==t)return"";if(t.constructor===Date)return JSON.stringify(t).slice(1,25);var n=t.toString().replace(f,l);return"boolean"==typeof r&&r||"function"==typeof r&&r(t,e)||Array.isArray(r)&&r[e]||function(t,e){for(var r=0;r<e.length;r++)if(-1<t.indexOf(e[r]))return!0;return!1}(n,s.BAD_DELIMITERS)||-1<n.indexOf(i)||" "===n.charAt(0)||" "===n.charAt(n.length-1)?a+n+a:n}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!r&&!!e.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=d,s.ParserHandle=m,s.NetworkStreamer=u,s.FileStreamer=h,s.StringStreamer=f,s.ReadableStreamStreamer=c,e.jQuery){var a=e.jQuery;a.fn.parse=function(t){var r=t.config||{},n=[];return this.each((function(t){if("INPUT"!==a(this).prop("tagName").toUpperCase()||"file"!==a(this).attr("type").toLowerCase()||!e.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)n.push({file:this.files[i],inputElem:this,instanceConfig:a.extend({},r)})})),i(),this;function i(){if(0!==n.length){var e,r,i,l=n[0];if(x(t.before)){var u=t.before(l.file,l.inputElem);if("object"==typeof u){if("abort"===u.action)return e=l.file,r=l.inputElem,i=u.reason,void(x(t.error)&&t.error({name:"AbortError"},e,r,i));if("skip"===u.action)return void o();"object"==typeof u.config&&(l.instanceConfig=a.extend(l.instanceConfig,u.config))}else if("skip"===u)return void o()}var h=l.instanceConfig.complete;l.instanceConfig.complete=function(t){x(h)&&h(t,l.file,l.inputElem),o()},s.parse(l.file,l.instanceConfig)}else x(t.complete)&&t.complete()}function o(){n.splice(0,1),i()}}}function l(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=b(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new m(e),(this._handle.streamer=this)._config=e}.call(this,t),this.parseChunk=function(t,r){if(this.isFirstChunk&&x(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(t);void 0!==i&&(t=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+t;this._partialLine="";var a=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=a.meta.cursor;this._finished||(this._partialLine=o.substring(l-this._baseIndex),this._baseIndex=l),a&&a.data&&(this._rowCount+=a.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)e.postMessage({results:a,workerId:s.WORKER_ID,finished:u});else if(x(this._config.chunk)&&!r){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!u||!x(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(t){x(this._config.error)?this._config.error(t):n&&this._config.error&&e.postMessage({workerId:s.WORKER_ID,error:t,finished:!1})}}function u(t){var e;(t=t||{}).chunkSize||(t.chunkSize=s.RemoteChunkSize),l.call(this,t),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),r||(e.onload=v(this._chunkLoaded,this),e.onerror=v(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var n in t)e.setRequestHeader(n,t[n])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{e.send(this._config.downloadRequestBody)}catch(t){this._chunkError(t.message)}r&&0===e.status&&this._chunkError()}},this._chunkLoaded=function(){4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:e.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(t){var e=t.getResponseHeader("Content-Range");return null===e?-1:parseInt(e.substring(e.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(t){var r=e.statusText||t;this._sendError(new Error(r))}}function h(t){var e,r;(t=t||{}).chunkSize||(t.chunkSize=s.LocalChunkSize),l.call(this,t);var n="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,r=t.slice||t.webkitSlice||t.mozSlice,n?((e=new FileReader).onload=v(this._chunkLoaded,this),e.onerror=v(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);t=r.call(t,this._start,i)}var o=e.readAsText(t,this._config.encoding);n||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function f(t){var e;l.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t,r=this._config.chunkSize;return r?(t=e.substring(0,r),e=e.substring(r)):(t=e,e=""),this._finished=!e,this.parseChunk(t)}}}function c(t){l.call(this,t=t||{});var e=[],r=!0,n=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):r=!0},this._streamData=v((function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}}),this),this._streamError=v((function(t){this._streamCleanUp(),this._sendError(t)}),this),this._streamEnd=v((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=v((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function m(t){var e,r,n,i=Math.pow(2,53),o=-i,a=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,l=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,u=this,h=0,f=0,c=!1,m=!1,g=[],w={data:[],errors:[],meta:{}};if(x(t.step)){var y=t.step;t.step=function(e){if(w=e,E())M();else{if(M(),0===w.data.length)return;h+=e.data.length,t.preview&&h>t.preview?r.abort():(w.data=w.data[0],y(w,u))}}}function v(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function M(){if(w&&n&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),n=!1),t.skipEmptyLines)for(var e=0;e<w.data.length;e++)v(w.data[e])&&w.data.splice(e--,1);return E()&&function(){if(w)if(Array.isArray(w.data[0])){for(var e=0;E()&&e<w.data.length;e++)w.data[e].forEach(r);w.data.splice(0,1)}else w.data.forEach(r);function r(e){x(t.transformHeader)&&(e=t.transformHeader(e)),g.push(e)}}(),function(){if(!w||!t.header&&!t.dynamicTyping&&!t.transform)return w;function e(e,r){var n,i=t.header?{}:[];for(n=0;n<e.length;n++){var o=n,s=e[n];t.header&&(o=n>=g.length?"__parsed_extra":g[n]),t.transform&&(s=t.transform(s,o)),s=S(o,s),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(s)):i[o]=s}return t.header&&(n>g.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+n,f+r):n<g.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+n,f+r)),i}var r=1;return!w.data.length||Array.isArray(w.data[0])?(w.data=w.data.map(e),r=w.data.length):w.data=e(w.data,0),t.header&&w.meta&&(w.meta.fields=g),f+=r,w}()}function E(){return t.header&&0===g.length}function S(e,r){return n=e,t.dynamicTypingFunction&&void 0===t.dynamicTyping[n]&&(t.dynamicTyping[n]=t.dynamicTypingFunction(n)),!0===(t.dynamicTyping[n]||t.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(t){if(a.test(t)){var e=parseFloat(t);if(o<e&&e<i)return!0}return!1}(r)?parseFloat(r):l.test(r)?new Date(r):""===r?null:r):r;var n}function k(t,e,r,n){var i={type:t,code:e,message:r};void 0!==n&&(i.row=n),w.errors.push(i)}this.parse=function(i,o,a){var l=t.quoteChar||'"';if(t.newline||(t.newline=function(t,e){t=t.substring(0,1048576);var r=new RegExp(p(e)+"([^]*?)"+p(e),"gm"),n=(t=t.replace(r,"")).split("\r"),i=t.split("\n"),o=1<i.length&&i[0].length<n[0].length;if(1===n.length||o)return"\n";for(var s=0,a=0;a<n.length;a++)"\n"===n[a][0]&&s++;return s>=n.length/2?"\r\n":"\r"}(i,l)),n=!1,t.delimiter)x(t.delimiter)&&(t.delimiter=t.delimiter(i),w.meta.delimiter=t.delimiter);else{var u=function(e,r,n,i,o){var a,l,u,h;o=o||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var f=0;f<o.length;f++){var c=o[f],m=0,p=0,g=0;u=void 0;for(var w=new d({comments:i,delimiter:c,newline:r,preview:10}).parse(e),y=0;y<w.data.length;y++)if(n&&v(w.data[y]))g++;else{var b=w.data[y].length;p+=b,void 0!==u?0<b&&(m+=Math.abs(b-u),u=b):u=b}0<w.data.length&&(p/=w.data.length-g),(void 0===l||m<=l)&&(void 0===h||h<p)&&1.99<p&&(l=m,a=c,h=p)}return{successful:!!(t.delimiter=a),bestDelimiter:a}}(i,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);u.successful?t.delimiter=u.bestDelimiter:(n=!0,t.delimiter=s.DefaultDelimiter),w.meta.delimiter=t.delimiter}var h=b(t);return t.preview&&t.header&&h.preview++,e=i,r=new d(h),w=r.parse(e,o,a),M(),c?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,r.abort(),e=x(t.chunk)?"":e.substring(r.getCharIndex())},this.resume=function(){u.streamer._halted?(c=!1,u.streamer.parseChunk(e,!0)):setTimeout(u.resume,3)},this.aborted=function(){return m},this.abort=function(){m=!0,r.abort(),w.meta.aborted=!0,x(t.complete)&&t.complete(w),e=""}}function p(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(t){var e,r=(t=t||{}).delimiter,n=t.newline,i=t.comments,o=t.step,a=t.preview,l=t.fastMode,u=e=void 0===t.quoteChar?'"':t.quoteChar;if(void 0!==t.escapeChar&&(u=t.escapeChar),("string"!=typeof r||-1<s.BAD_DELIMITERS.indexOf(r))&&(r=","),i===r)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var h=0,f=!1;this.parse=function(t,s,c){if("string"!=typeof t)throw new Error("Input must be a string");var m=t.length,d=r.length,g=n.length,w=i.length,y=x(o),b=[],v=[],M=[],E=h=0;if(!t)return j();if(l||!1!==l&&-1===t.indexOf(e)){for(var S=t.split(n),k=0;k<S.length;k++){if(M=S[k],h+=M.length,k!==S.length-1)h+=n.length;else if(c)return j();if(!i||M.substring(0,w)!==i){if(y){if(b=[],O(M.split(r)),P(),f)return j()}else O(M.split(r));if(a&&a<=k)return b=b.slice(0,a),j(!0)}}return j()}for(var A=t.indexOf(r,h),T=t.indexOf(n,h),_=new RegExp(p(u)+p(e),"g"),R=t.indexOf(e,h);;)if(t[h]!==e)if(i&&0===M.length&&t.substring(h,h+w)===i){if(-1===T)return j();h=T+g,T=t.indexOf(n,h),A=t.indexOf(r,h)}else{if(-1!==A&&(A<T||-1===T)){if(!(A<R)){M.push(t.substring(h,A)),h=A+d,A=t.indexOf(r,h);continue}var C=U(A,R,T);if(C&&void 0!==C.nextDelim){A=C.nextDelim,R=C.quoteSearch,M.push(t.substring(h,A)),h=A+d,A=t.indexOf(r,h);continue}}if(-1===T)break;if(M.push(t.substring(h,T)),D(T+g),y&&(P(),f))return j();if(a&&b.length>=a)return j(!0)}else for(R=h,h++;;){if(-1===(R=t.indexOf(e,R+1)))return c||v.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:h}),z();if(R===m-1)return z(t.substring(h,R).replace(_,e));if(e!==u||t[R+1]!==u){if(e===u||0===R||t[R-1]!==u){-1!==A&&A<R+1&&(A=t.indexOf(r,R+1)),-1!==T&&T<R+1&&(T=t.indexOf(n,R+1));var N=I(-1===T?A:Math.min(A,T));if(t[R+1+N]===r){M.push(t.substring(h,R).replace(_,e)),t[h=R+1+N+d]!==e&&(R=t.indexOf(e,h)),A=t.indexOf(r,h),T=t.indexOf(n,h);break}var F=I(T);if(t.substring(R+1+F,R+1+F+g)===n){if(M.push(t.substring(h,R).replace(_,e)),D(R+1+F+g),A=t.indexOf(r,h),R=t.indexOf(e,h),y&&(P(),f))return j();if(a&&b.length>=a)return j(!0);break}v.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:h}),R++}}else R++}return z();function O(t){b.push(t),E=h}function I(e){var r=0;if(-1!==e){var n=t.substring(R+1,e);n&&""===n.trim()&&(r=n.length)}return r}function z(e){return c||(void 0===e&&(e=t.substring(h)),M.push(e),h=m,O(M),y&&P()),j()}function D(e){h=e,O(M),M=[],T=t.indexOf(n,h)}function j(t){return{data:b,errors:v,meta:{delimiter:r,linebreak:n,aborted:f,truncated:!!t,cursor:E+(s||0)}}}function P(){o(j()),b=[],v=[]}function U(n,i,o){var s={nextDelim:void 0,quoteSearch:void 0},a=t.indexOf(e,i+1);if(i<n&&n<a&&(a<o||-1===o)){var l=t.indexOf(r,a);if(-1===l)return s;a<l&&(a=t.indexOf(e,a+1)),s=U(l,a,o)}else s={nextDelim:n,quoteSearch:i};return s}},this.abort=function(){f=!0},this.getCharIndex=function(){return h}}function g(t){var e=t.data,r=i[e.workerId],n=!1;if(e.error)r.userError(e.error,e.file);else if(e.results&&e.results.data){var o={abort:function(){n=!0,w(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(x(r.userStep)){for(var s=0;s<e.results.data.length&&(r.userStep({data:e.results.data[s],errors:e.results.errors,meta:e.results.meta},o),!n);s++);delete e.results}else x(r.userChunk)&&(r.userChunk(e.results,o,e.file),delete e.results)}e.finished&&!n&&w(e.workerId,e.results)}function w(t,e){var r=i[t];x(r.userComplete)&&r.userComplete(e),r.terminate(),delete i[t]}function y(){throw new Error("Not implemented.")}function b(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var r in t)e[r]=b(t[r]);return e}function v(t,e){return function(){t.apply(e,arguments)}}function x(t){return"function"==typeof t}return n&&(e.onmessage=function(t){var r=t.data;if(void 0===s.WORKER_ID&&r&&(s.WORKER_ID=r.workerId),"string"==typeof r.input)e.postMessage({workerId:s.WORKER_ID,results:s.parse(r.input,r.config),finished:!0});else if(e.File&&r.input instanceof File||r.input instanceof Object){var n=s.parse(r.input,r.config);n&&e.postMessage({workerId:s.WORKER_ID,results:n,finished:!0})}}),(u.prototype=Object.create(l.prototype)).constructor=u,(h.prototype=Object.create(l.prototype)).constructor=h,(f.prototype=Object.create(f.prototype)).constructor=f,(c.prototype=Object.create(l.prototype)).constructor=c,s}()}));function Qt(t){let e=t.split(/\r?\n/).filter(t=>!t.match(/^\s*$/)),r=function(t){let e={comments:[],methodSteps:[]};for(let[r,n]of t.entries())if(n.match(/^Instrument/))e.instrument=te(n);else if(n.match(/^InstSerial/))e.instrumentSerial=te(n);else if(n.match(/^Sample/))e.sampleName=te(n);else if(n.match(/^Size/))e.weight=parseFloat(te(n)),e.weightUnit=te(n,2);else if(n.match(/^Xcomment|^Comment/))e.comments.push(te(n));else if(n.match(/^Method/))e.method=te(n);else if(n.match(/^Mode/))e.mode=te(n);else if(n.match(/^File/))e.file=te(n);else if(n.match(/^Date/))e.date=te(n);else if(n.match(/^Time/))e.time=te(n);else if(n.match(/^OrgMethod/))e.methodSteps.push(te(n));else if(n.match(/^Controls/))e.controls=te(n);else if(n.match(/^FurnaceType/))e.furnaceType=te(n);else if(n.match(/^Operator/))e.operator=te(n);else if(n.match(/^RunSerial/))e.runSerial=te(n);else if(n.match(/^ProcName/))e.procName=te(n);else if(n.match(/^StartOfData/)){e.dataStart=r+1;break}return e}(e),n=e.slice(r.dataStart,e.length).filter(t=>!t.startsWith("-")).map(t=>t.split(/\s+/).map(Number));r.balancePurgeFlow=[],r.samplePurgeFlow=[];let i={meta:r,data:{time:[],weight:[],temperature:[]}};return i.data.time=n.map(t=>t[0]),i.data.temperature=n.map(t=>t[1]),i.data.weight=n.map(t=>t[2]),i.meta.balancePurgeFlow=n.map(t=>t[3]),i.meta.samplePurgeFlow=n.map(t=>t[4]),i}function te(t,e=1){return t.split(/\t/)[e].replace(/^[ \t]*(.*?)[ \t]*$/,"$1")}t.AnalysesManager=class{constructor(){this.analyses=[]}addAnalysis(t){let e=this.getAnalysisIndex(t.id);void 0===e?this.analyses.push(t):this.analyses[e]=t}getAnalyses(t={}){const{ids:e}=t;let r=[];for(const t of this.analyses)e&&!e.includes(t.id)||r.push(t);return r}removeAnalysis(t){let e=this.getAnalysisIndex(t);if(void 0!==e)return this.analyses.splice(e,1)}getAnalysisIndex(t){if(t)for(let e=0;e<this.analyses.length;e++){if(this.analyses[e].id===t)return e}}includes(t){return!isNaN(this.getAnalysisIndex(t))}},t.Analysis=At,t.fromJcamp=function(t,e={}){let r=new At(e);return function(t,e){let r=function(t,e={}){(e=Object.assign({},Bt,e)).wantXY=!e.withoutXY,e.start=Date.now();let r=[],n={profiling:!!e.profiling&&[],logs:[],entries:[]},i={children:[]},o=i,s=[],a=new Yt;if("string"!=typeof t)throw new TypeError("the JCAMP should be a string");Ut(n,"Before split to LDRS",e);let l=t.replace(/[\r\n]+##/g,"\n##").split("\n##");Ut(n,"Split to LDRS",e),l[0]&&(l[0]=l[0].replace(/^[\r\n ]*##/,""));for(let t of l){let i=t.indexOf("="),l=i>0?t.substring(0,i):t,u=i>0?t.substring(i+1).trim():"",h=l.replace(/[_ -]/g,"").toUpperCase();if("DATATABLE"===h){let t=u.indexOf("\n");if(-1===t&&(t=u.indexOf("\r")),t>0){let e=u.substring(0,t).split(/[ ,;\t]+/);qt(o,a,e[0]),a.datatable=e[0],e[1]&&e[1].indexOf("PEAKS")>-1?h="PEAKTABLE":e[1]&&(e[1].indexOf("XYDATA")||e[0].indexOf("++")>0)&&(h="XYDATA",a.deltaX=(a.lastX-a.firstX)/(a.nbPoints-1))}}if("XYDATA"!==h)if("PEAKTABLE"!==h)if("PEAKASSIGNMENTS"!==h){if("TITLE"===h){let t=o;t.children||(t.children=[]),o={spectra:[],ntuples:{},info:{},meta:{}},t.children.push(o),s.push(t),r.push(o),o.title=u}else"DATATYPE"===h?(o.dataType=u,u.toLowerCase().indexOf("nd")>-1&&(o.twoD=!0)):"NTUPLES"===h?u.toLowerCase().indexOf("nd")>-1&&(o.twoD=!0):"DATACLASS"===h?o.dataClass=u:"XUNITS"===h?a.xUnits=u:"YUNITS"===h?a.yUnits=u:"FIRSTX"===h?a.firstX=parseFloat(u):"LASTX"===h?a.lastX=parseFloat(u):"FIRSTY"===h?a.firstY=parseFloat(u):"LASTY"===h?a.lastY=parseFloat(u):"NPOINTS"===h?a.nbPoints=parseFloat(u):"XFACTOR"===h?a.xFactor=parseFloat(u):"YFACTOR"===h?a.yFactor=parseFloat(u):"MAXX"===h?a.maxX=parseFloat(u):"MINX"===h?a.minX=parseFloat(u):"MAXY"===h?a.maxY=parseFloat(u):"MINY"===h?a.minY=parseFloat(u):"DELTAX"===h?a.deltaX=parseFloat(u):".OBSERVEFREQUENCY"===h||"$SFO1"===h?a.observeFrequency||(a.observeFrequency=parseFloat(u)):".OBSERVENUCLEUS"===h?a.xType||(o.xType=u.replace(/[^a-zA-Z0-9]/g,"")):"$OFFSET"===h?(o.shiftOffsetNum=0,a.shiftOffsetVal||(a.shiftOffsetVal=parseFloat(u))):"$REFERENCEPOINT"===h||("VARNAME"===h?o.ntuples.varname=u.split(Xt):"SYMBOL"===h?o.ntuples.symbol=u.split(Xt):"VARTYPE"===h?o.ntuples.vartype=u.split(Xt):"VARFORM"===h?o.ntuples.varform=u.split(Xt):"VARDIM"===h?o.ntuples.vardim=Nt(u.split(Xt)):"UNITS"===h?o.ntuples.units=u.split(Xt):"FACTOR"===h?o.ntuples.factor=Nt(u.split(Xt)):"FIRST"===h?o.ntuples.first=Nt(u.split(Xt)):"LAST"===h?o.ntuples.last=Nt(u.split(Xt)):"MIN"===h?o.ntuples.min=Nt(u.split(Xt)):"MAX"===h?o.ntuples.max=Nt(u.split(Xt)):".NUCLEUS"===h?(o.ntuples&&(o.ntuples.nucleus=u.split(Xt)),o.twoD&&(o.yType=u.split(Xt)[0])):"PAGE"===h?(a.page=u.trim(),a.pageValue=parseFloat(u.replace(/^.*=/,"")),a.pageSymbol=a.page.replace(/[=].*/,"")):"RETENTIONTIME"===h?a.pageValue=parseFloat(u):Rt(h)?a[Ct(h)]=u:"SAMPLEDESCRIPTION"===h?a.sampleDescription=u:"END"===h&&(o=s.pop()));if(o&&o.info&&o.meta&&h.match(e.keepRecordsRegExp)){let t,r,n=u.trim();if(l.startsWith("$")?(r=e.canonicMetadataLabels?h.substring(1):l.substring(1),t=o.meta):(r=e.canonicDataLabels?h:l,t=o.info),e.dynamicTyping){let t=Number.parseFloat(n);Number.isNaN(t)||(n=t)}t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(n)):t[r]=n}}else e.wantXY&&(u.match(/.*(XYA).*/)&&Dt(a,u),o.spectra.push(a),a=new Yt);else e.wantXY&&(Vt(a),zt(a,u,n),o.spectra.push(a),a=new Yt);else e.wantXY&&(Vt(a),u.match(/.*\+\+.*/)?(a.deltaX||(a.deltaX=(a.lastX-a.firstX)/(a.nbPoints-1)),Ft(a,u)):zt(a,u,n),o.spectra.push(a),a=new Yt)}return Ut(n,"Finished parsing",e),Lt(r,n,e),Ut(n,"Total time",e),n.entries=i.children,n.flatten=r,n}(e,{keepRecordsRegExp:/.*/});for(let e of r.flatten){let r=e.spectra[0];if(r.variables)for(let t in r.variables){const e=r.variables[t];e.label||(e.label=e.name||e.symbol||t,e.units&&!e.label.includes(e.units)&&(e.label+=` [${e.units}]`))}else{const t={};r.variables=t,t.x={label:r.xUnits,symbol:"X",data:r.data.x||r.data.X},t.y={label:r.yUnits,symbol:"Y",data:r.data.y||r.data.Y}}t.pushSpectrum(r.variables,{dataType:e.dataType,title:e.title,meta:e.meta})}}(r,t),r},t.fromPerkinElmer=function(t){let e=new At,r=function(t){let e=t.split(/[\r\n]+/),r={meta:{},data:{time:[],weight:[],temperature:[]}},n="",i=!1;for(let t of e){if(i)t.startsWith("1) TGA")?i=!1:(r.meta["Method Steps"]||(r.meta["Method Steps"]=""),r.meta["Method Steps"]+=t.replace(/\t/g,"  ")+"\n");else if(t.match(/^[a-zA-Z -]+$/))n=Zt(t);else if(t.match(/.*:.*/)){let e=t.indexOf(":"),i=t.substring(0,e),o=Zt(t.substring(e+1));r.meta[(n?n+"_":"")+i]=o}else if(t.match(/^[0-9\t .]+$/)){let e=t.replace(/^\t/,"").split("\t");r.data.time.push(Number(60*e[0])),r.data.weight.push(Number(e[1])),r.data.temperature.push(Number(e[4]))}t.startsWith("Method Steps:")&&(i=!0)}return r}(t);return e.pushSpectrum({x:{data:r.data.temperature,label:"Temperature [C]"},y:{data:r.data.weight,label:"Weight [mg]"}},{dataType:"TGA",title:r.meta["Sample ID"],meta:r.meta}),e.pushSpectrum({x:{data:r.data.time,label:"Time [s]"},y:{data:r.data.weight,label:"Weight [mg]"}},{dataType:"TGA",title:r.meta["Sample ID"],meta:r.meta}),e},t.fromPerkinElmerCSV=function(t){let e=Jt.parse(t,{skipEmptyLines:!0,header:!0,dynamicTyping:!0}).data,r=new At;return r.pushSpectrum({x:{data:e.map(t=>t["Sample Temperature"]),label:"Sample temperature [C]",type:"dependent"},y:{data:e.map(t=>t["Unsubtracted Weight"]),label:"Weight [mg]",type:"dependent"},p:{data:e.map(t=>t["Program Temperature"]),label:"Program temperature [C]",type:"dependent"},t:{data:e.map(t=>t.Time),label:"Time [s]",type:"independent"}},{dataType:"TGA"}),r},t.fromTAInstruments=function(t){let e=new At,r=Qt(t);return e.pushSpectrum({x:{data:r.data.temperature,type:"dependent",label:"Program temperature [C]"},y:{data:r.data.weight,type:"dependent",label:"Weight [mg]"},t:{data:r.data.time,type:"independent",label:"Time [s]"}},{dataType:"TGA",title:r.meta.sampleName,meta:r.meta}),e},t.getJSGraph=function(t,e={}){const{colors:r=Wt,selector:n,normalization:i}=e;let o=[],s="",a="";for(let e=0;e<t.length;e++){const l=t[e];let u={},h=l.getNormalizedSpectrum({selector:n,normalization:i});h&&(s||(s=h.variables.x.label),a||(a=h.variables.y.label),Kt(u,l,{color:r[e]}),u.data={x:h.variables.x.data,y:h.variables.y.data},o.push(u))}return{axes:{x:{label:s,unit:"",unitWrapperBefore:"",unitWrapperAfter:"",flipped:!1,display:!0},y:{label:a,unit:"",unitWrapperBefore:"",unitWrapperAfter:"",flipped:!1,display:!0}},series:o}},t.getNormalizationAnnotations=function(t={},e){let{exclusions:r=[]}=t,n=[];return r=r.filter(t=>!t.ignore),n=r.map(t=>({type:"rect",position:[{x:t.from,y:e.y.min},{x:t.to,y:e.y.max}],strokeWidth:0,fillColor:"rgba(255,255,224,1)"})),void 0!==t.from&&n.push({type:"rect",position:[{x:Number.MIN_SAFE_INTEGER,y:e.y.min},{x:t.from,y:e.y.max}],strokeWidth:0,fillColor:"rgba(255,255,224,1)"}),void 0!==t.to&&n.push({type:"rect",position:[{x:t.to,y:e.y.min},{x:Number.MAX_SAFE_INTEGER,y:e.y.max}],strokeWidth:0,fillColor:"rgba(255,255,224,1)"}),n},t.toJcamp=function(t,e={}){let r=[];for(let n of t.spectra)r.push(Gt(n,e));return r.join("\n")},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=tga-spectrum.min.js.map
